#!/usr/bin/env node
import e from"commander";import t from"chalk";import*as o from"path";import n,{dirname as r,resolve as s,normalize as i,sep as a,extname as l,relative as c,basename as u,join as p,posix as d}from"path";import m from"fs-extra";import{spawn as f,exec as h}from"child_process";import g from"prettier";import y from"axios";import{ESLint as w}from"eslint";import v from"cross-spawn";import{fileURLToPath as x,pathToFileURL as b}from"url";import{createRequire as E,builtinModules as $}from"module";import*as S from"@babel/core";import{createFilter as j,makeLegalIdentifier as k,attachScopes as _,extractAssignedNames as O,dataToEsm as F}from"@rollup/pluginutils";import{addNamed as D}from"@babel/helper-module-imports";import I from"deepmerge";import P from"is-module";import N,{realpathSync as C,existsSync as R,readFileSync as M,statSync as A,readFile as T,promises as q}from"fs";import{promisify as L}from"util";import U from"resolve";import W from"commondir";import{fdir as H}from"fdir";import{walk as B}from"estree-walker";import J from"magic-string";import K from"is-reference";import G from"mini-svg-data-uri";import{createServer as z}from"https";import{createServer as Y}from"http";import V from"mime";import Q from"opener";import{createServer as Z}from"livereload";import{createServer as X,createConnection as ee}from"net";import te from"typescript";import oe from"rollup-plugin-postcss";import ne from"autoprefixer";import re from"handlebars";import se from"postcss-px-to-viewport";import ie from"@tailwindcss/postcss";import ae from"postcss-import";class le{constructor(e={}){this.options={models:[{name:"bigscience/bloom-560m",apiKey:process.env.HUGGING_FACE_API_KEY,endpoint:"https://api-inference.huggingface.co/models",type:"huggingface"},{name:"qwen-7b-chat",apiKey:process.env.DASHSCOPE_API_KEY,endpoint:"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",type:"dashscope"},{name:"gpt-3.5-turbo",apiKey:process.env.OPENAI_API_KEY,endpoint:"https://api.openai.com/v1/chat/completions",type:"openai"}].filter((e=>e.apiKey)),temperature:.7,maxTokens:2e3,...e}}async reviewFile(e,o){try{const t=m.readFileSync(e,"utf8"),r=n.relative(process.cwd(),e),s=`请对以下代码进行审核，重点关注：\n1. 代码质量和可读性\n2. 潜在的性能问题\n3. 安全隐患\n4. 最佳实践\n5. 可能的改进建议\n\n文件路径：${r}\n代码内容：\n\`\`\`\n${t}\n\`\`\`\n\n请用中文回复，并按照以下格式输出：\n# 代码审核报告\n\n## 文件信息\n- 文件路径：${r}\n- 审核时间：${(new Date).toLocaleString()}\n- 使用模型：${o.name}\n\n## 审核结果\n[在这里详细说明审核结果]\n\n## 改进建议\n[在这里列出具体的改进建议]\n\n## 总结\n[在这里总结主要发现和建议]`;let i;switch(o.type){case"huggingface":return i=await y.post(`${o.endpoint}/${o.name}`,{inputs:s,parameters:{max_length:this.options.maxTokens,temperature:this.options.temperature,return_full_text:!1}},{headers:{Authorization:`Bearer ${o.apiKey}`,"Content-Type":"application/json"}}),i.data[0].generated_text;case"dashscope":return i=await y.post(o.endpoint,{model:o.name,input:{messages:[{role:"user",content:s}]},parameters:{temperature:this.options.temperature,max_tokens:this.options.maxTokens}},{headers:{Authorization:`Bearer ${o.apiKey}`,"Content-Type":"application/json"}}),i.data.output.text;case"openai":return i=await y.post(o.endpoint,{model:o.name,messages:[{role:"user",content:s}],temperature:this.options.temperature,max_tokens:this.options.maxTokens},{headers:{Authorization:`Bearer ${o.apiKey}`,"Content-Type":"application/json"}}),i.data.choices[0].message.content;default:throw new Error(`不支持的模型类型：${o.type}`)}}catch(n){return console.error(t.red(`使用模型 ${o.name} 审核文件 ${e} 时出错：${n.message}`)),null}}async reviewDirectory(e){const o=[],r={},s=e=>{m.readdirSync(e).forEach((t=>{const r=n.join(e,t);m.statSync(r).isDirectory()?s(r):this.shouldReviewFile(t)&&o.push(r)}))};s(e),this.options.models.forEach((e=>{r[e.name]=[]}));for(const e of o){console.log(t.blue(`正在审核文件：${e}`));for(const o of this.options.models){console.log(t.blue(`使用模型 ${o.name} 进行审核...`));const n=await this.reviewFile(e,o);n&&r[o.name].push(n)}}return r}shouldReviewFile(e){return[".js",".jsx",".ts",".tsx",".vue",".py",".java",".cpp",".c",".cs"].some((t=>e.endsWith(t)))}generateHtmlReport(e){const t=`\n<!DOCTYPE html>\n<html lang="zh-CN">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>多模型代码审核对比报告</title>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        h1 {\n            color: #2c3e50;\n            border-bottom: 2px solid #eee;\n            padding-bottom: 10px;\n        }\n        h2 {\n            color: #34495e;\n            margin-top: 30px;\n        }\n        .model-section {\n            margin-bottom: 40px;\n            padding: 20px;\n            border: 1px solid #eee;\n            border-radius: 8px;\n        }\n        .model-header {\n            background-color: #f8f9fa;\n            padding: 10px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        pre {\n            background-color: #f8f9fa;\n            padding: 15px;\n            border-radius: 5px;\n            overflow-x: auto;\n        }\n        code {\n            font-family: 'Courier New', Courier, monospace;\n            background-color: #f8f9fa;\n            padding: 2px 5px;\n            border-radius: 3px;\n        }\n        .file-info {\n            background-color: #f8f9fa;\n            padding: 10px;\n            border-radius: 5px;\n            margin: 10px 0;\n        }\n        .timestamp {\n            color: #666;\n            font-size: 0.9em;\n        }\n        .model-comparison {\n            margin-top: 40px;\n            padding: 20px;\n            background-color: #f8f9fa;\n            border-radius: 8px;\n        }\n        .model-comparison h2 {\n            color: #2c3e50;\n            margin-bottom: 20px;\n        }\n        .comparison-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 20px;\n        }\n        .comparison-table th,\n        .comparison-table td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        .comparison-table th {\n            background-color: #f1f1f1;\n        }\n    </style>\n</head>\n<body>\n    <h1>多模型代码审核对比报告</h1>\n    <div class="timestamp">生成时间：${(new Date).toLocaleString()}</div>\n    \n    ${Object.entries(e).map((([e,t])=>`\n        <div class="model-section">\n            <div class="model-header">\n                <h2>模型：${e}</h2>\n            </div>\n            ${t.map((e=>`\n                <div class="review-result">\n                    ${e}\n                </div>\n            `)).join("<hr>")}\n        </div>\n    `)).join("")}\n\n    <div class="model-comparison">\n        <h2>模型对比分析</h2>\n        <table class="comparison-table">\n            <thead>\n                <tr>\n                    <th>模型名称</th>\n                    <th>审核文件数</th>\n                    <th>平均响应时间</th>\n                    <th>特点分析</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${Object.entries(e).map((([e,t])=>`\n                    <tr>\n                        <td>${e}</td>\n                        <td>${t.length}</td>\n                        <td>${(t.reduce(((e,t)=>e+t.responseTime),0)/t.length).toFixed(2)}ms</td>\n                        <td>${this.getModelAnalysis(e,t)}</td>\n                    </tr>\n                `)).join("")}\n            </tbody>\n        </table>\n    </div>\n</body>\n</html>`,o=n.join(process.cwd(),"code-review-comparison.html");return m.writeFileSync(o,t),o}getModelAnalysis(e,t){return{"bigscience/bloom-560m":"开源模型，响应较快，适合基础代码审查","qwen-7b-chat":"中文理解能力强，适合中文项目代码审查","gpt-3.5-turbo":"通用性强，代码审查质量较高"}[e]||"暂无分析"}}async function ce(e={}){const{targetDir:t=process.cwd(),extensions:o=[".js",".jsx",".ts",".tsx"],fix:n=!1,ignorePath:r=".eslintignore"}=e;try{console.log(`执行目录：${t}`);const e=new w({cwd:t,fix:n}),o=await e.lintFiles(["."]),r=await e.lintFiles(o.map((e=>e.filePath))),s=(await e.loadFormatter("stylish")).format(r);console.log(s);const i=r.reduce(((e,t)=>{var o;return function(){const e=process.version;return parseInt(e.split(".")[0].replace("v",""))>=14}()?e+(null!==(o=null==t?void 0:t.errorCount)&&void 0!==o?o:0):e+(t&&t.errorCount?t.errorCount:0)}),0);return i}catch(e){return console.error("ESLint 检查失败：",e.message),1}}const ue=x(import.meta.url),pe=r(ue),de=E(import.meta.url);const me=x(import.meta.url),fe=r(me),he=E(import.meta.url);const ge="bundled",ye="inline",we="runtime",ve="external",xe="\0rollupPluginBabelHelpers.js";function be({types:e}){return{pre(t){const o={};t.set("helperGenerator",(n=>t.availableHelper(n)?o[n]?e.cloneNode(o[n]):o[n]=D(t.path,n,xe):null))}}}const Ee=(e,t)=>({...e,plugins:e.plugins.concat(t)});const $e=/[\\^$.*+?()[\]{}|]/g,Se=e=>e.replace($e,"\\$&");const je="__ROLLUP__PREFLIGHT_CHECK_DO_NOT_TOUCH__",ke=`export default "${je}";`;function _e(){return{visitor:{StringLiteral(e,t){e.node.value===je&&e.replaceWith(t.file.addHelper("inherits"))}}}}const Oe=(e,t,o)=>`You have declared using "${t}" babelHelpers, but transforming ${o} resulted in "${e}". Please check your configuration.`,Fe=/[\\/]+helpers[\\/]+(esm[\\/]+)?inherits/;async function De(e,t,o,n,r,s){const i=await(S.loadPartialConfigAsync||S.loadPartialConfig)(t);if(!i)return null;let a=o.config?await o.config.call(r,i,{code:e,customOptions:n}):i.options;if(s&&(a=await s(a)),!o.result){const{code:t,map:o}=await S.transformAsync(e,a);return{code:t,map:o}}const l=await S.transformAsync(e,a),{code:c,map:u}=await o.result.call(r,l,{code:e,customOptions:n,config:i,transformOptions:a});return{code:c,map:u}}const Ie=({extensions:e=S.DEFAULT_EXTENSIONS,sourcemap:t=!0,sourcemaps:o=!0,sourceMap:n=!0,sourceMaps:r=!0,...s}={})=>({extensions:e,plugins:[],sourceMaps:t&&o&&n&&r,...s,caller:{name:"@rollup/plugin-babel",...s.caller}}),Pe=({deprecatedOption:e,suggestion:t})=>{console.warn(`\`${e}\` has been removed in favor a \`babelHelpers\` option. Try changing your configuration to \`${t}\`. Refer to the documentation to learn more: https://github.com/rollup/plugins/tree/master/packages/babel#babelhelpers`)};function Ne(e={},t={}){if(!t.options)return{customOptions:null,pluginOptionsWithOverrides:e};const o=t.options(e);if("function"==typeof o.then)throw new Error(".options hook can't be asynchronous. It should return `{ customOptions, pluginsOptions }` synchronously.");return{customOptions:o.customOptions||null,pluginOptionsWithOverrides:o.pluginOptions||e}}const Ce=()=>({});const Re=function(e=Ce){const t=e(S);return e=>{const{customOptions:o,pluginOptionsWithOverrides:n}=Ne(e,t);let r,s,i,a;return{name:"babel",options(){let e,t,o,l;({exclude:e,extensions:o,babelHelpers:r,include:t,filter:l,skipPreflightCheck:a,...s}=(({skipPreflightCheck:e=!1,...t},o)=>("runtimeHelpers"in t?Pe({deprecatedOption:"runtimeHelpers",suggestion:"babelHelpers: 'runtime'"}):"externalHelpers"in t?Pe({deprecatedOption:"externalHelpers",suggestion:"babelHelpers: 'external'"}):t.babelHelpers||console.warn("babelHelpers: 'bundled' option was used by default. It is recommended to configure this option explicitly, read more here: https://github.com/rollup/plugins/tree/master/packages/babel#babelhelpers"),Ie({...t,skipPreflightCheck:e,babelHelpers:t.babelHelpers||ge,caller:{supportsStaticESM:!0,supportsDynamicImport:!0,supportsTopLevelAwait:!0,supportsExportNamespaceFrom:!o.match(/^1\.2[0-5]\./),...t.caller}})))(n,this.meta.rollupVersion));const c=new RegExp(`(${o.map(Se).join("|")})$`);if(l&&(t||e))throw new Error("Could not handle include or exclude with custom filter together");const u="function"==typeof l?l:j(t,e);return i=e=>c.test(function(e){const[t,o]=e.split("?");return{bareId:t,query:o,suffix:o?`?${o}`:""}}(e).bareId)&&u(e),null},resolveId:e=>e!==xe?null:e,load:e=>e!==xe?null:S.buildExternalHelpers(null,"module"),transform(e,n){return i(n)?n===xe?null:De(e,{...s,filename:n},t,o,this,(async e=>(a||await async function(e,t,o){const n=Ee(o,_e),r=(await S.transformAsync(ke,n)).code;if(/export (d|{)/.test(r)||e.error("Rollup requires that your Babel configuration keeps ES6 module syntax intact. Unfortunately it looks like your configuration specifies a module transformer to replace ES6 modules with another module format. To continue you have to disable it.\n\nMost commonly it's a CommonJS transform added by @babel/preset-env - in such case you should disable it by adding `modules: false` option to that preset (described in more detail here - https://github.com/rollup/plugins/tree/master/packages/babel#modules )."),Fe.test(r)){if(t===we)return;e.error(Oe(we,t,o.filename))}if(r.includes("babelHelpers.inherits")){if(t===ve)return;e.error(Oe(ve,t,o.filename))}if(r.includes("Super expression must either be null or a function")){if(t===ye||t===ge)return;t!==we||o.plugins.length||e.error(`You must use the \`@babel/plugin-transform-runtime\` plugin when \`babelHelpers\` is "${we}".\n`),e.error(Oe(ye,t,o.filename))}e.error("An unexpected situation arose. Please raise an issue at https://github.com/rollup/plugins/issues. Thanks!")}(this,r,e),r===ge?Ee(e,be):e))):null}}}}();!function(e=Ce){const t=e(S)}();var Me="^2.78.0||^3.0.0||^4.0.0";L(N.access);const Ae=L(N.readFile),Te=L(N.realpath),qe=L(N.stat);async function Le(e){try{return(await qe(e)).isFile()}catch{return!1}}async function Ue(e){return await Le(e)?Te(e):e}const We=e=>{if("ENOENT"===e.code)return!1;throw e},He=e=>{const t=new Map,o=async(o,n)=>{!1===t.has(o)&&t.set(o,e(o).catch((e=>{throw t.delete(o),e})));try{const e=t.get(o);return n(null,await e)}catch(e){return n(e)}};return o.clear=()=>t.clear(),o},Be=He((async e=>{try{return(await qe(e)).isDirectory()}catch(e){return We(e)}})),Je=He((async e=>{try{return(await qe(e)).isFile()}catch(e){return We(e)}})),Ke=He(Ae);function Ge(e){if(e.startsWith(".")||e.startsWith("/"))return null;const t=e.split("/");return"@"===t[0][0]?`${t[0]}/${t[1]}`:t[0]}function ze(e){const{cache:t,extensions:o,pkg:n,mainFields:i,preserveSymlinks:a,useBrowserOverrides:c,rootDir:u,ignoreSideEffectsForRoot:p}=e;let{pkgPath:d}=e;if(t.has(d))return t.get(d);a||(d=C(d));const m=r(d),f={packageJson:{...n},packageJsonPath:d,root:m,resolvedMainField:"main",browserMappedMain:!1,resolvedEntryPoint:""};let h=!1;for(let e=0;e<i.length;e++){const t=i[e];if("string"==typeof n[t]){n.main=n[t],f.resolvedMainField=t,h=!0;break}}const g={cachedPkg:n,hasModuleSideEffects:()=>null,hasPackageEntry:!1!==h||-1!==i.indexOf("main"),packageBrowserField:c&&"object"==typeof n.browser&&Object.keys(n.browser).reduce(((e,t)=>{let r=n.browser[t];if(r&&"."===r[0]&&(r=s(m,r)),e[t]=r,"."===t[0]){const n=s(m,t);e[n]=r,l(t)||o.reduce(((e,o)=>(e[n+o]=e[t],e)),e)}return e}),{}),packageInfo:f},y=g.packageBrowserField;if(c&&"object"==typeof n.browser&&y.hasOwnProperty(n.main)?(f.resolvedEntryPoint=y[n.main],f.browserMappedMain=!0):(f.resolvedEntryPoint=s(m,n.main||"index.js"),f.browserMappedMain=!1),!p||u!==m){const e=n.sideEffects;if("boolean"==typeof e)g.hasModuleSideEffects=()=>e;else if(Array.isArray(e)){const t=e.map((e=>e.includes("/")?e:`**/${e}`));g.hasModuleSideEffects=j(t,null,{resolve:m})}}return t.set(d,g),g}function Ye(e,t){return t.some((t=>e.endsWith(t)))}async function Ve(e,t){const{root:o}=n.parse(e);let r=e;for(;r!==o&&!Ye(r,t);){const e=n.join(r,"package.json");if(await Le(e)){const t=N.readFileSync(e,"utf-8");return{pkgJson:JSON.parse(t),pkgPath:r,pkgJsonPath:e}}r=n.resolve(r,"..")}return null}function Qe(e){return"object"==typeof e&&Object.keys(e).every((e=>!e.startsWith(".")))}function Ze(e){return"object"==typeof e&&!Qe(e)}function Xe(e,t){return`Could not resolve import "${e}" in ${t}`}function et(e,t,o){const{importSpecifier:n,importer:r,pkgJsonPath:s}=e;return`${Xe(n,r)} using ${o?"imports":"exports"} defined in ${s}.${t?` ${t}`:""}`}class tt extends Error{}class ot extends tt{constructor(e,t){super(et(e,`Invalid "exports" field. ${t}`))}}class nt extends tt{constructor(e,t,o){super(et(e,o,t))}}class rt extends tt{constructor(e,t){super(et(e,t))}}function st(e,t){const o=["",".","..",...t];return e.some((e=>o.includes(e)||o.includes(decodeURI(e))))}async function it(e,{target:t,patternMatch:o,isImports:n}){if("string"==typeof t){if(!t.startsWith("./")){if(!n||["/","../"].some((e=>t.startsWith(e)))||function(e){try{return!!new URL(e)}catch(e){return!1}}(t))throw new rt(e,`Invalid mapping: "${t}".`);if("string"==typeof o){const n=await e.resolveId(t.replace(/\*/g,o),e.pkgURL.href);return n?b(n.location).href:null}const r=await e.resolveId(t,e.pkgURL.href);return r?b(r.location).href:null}e.allowExportsFolderMapping&&(t=t.replace(/\/$/,"/*"));{const o=t.split(/\/|\\/),n=o.indexOf(".");if(-1!==n&&o.slice(n),-1!==n&&n<o.length-1&&st(o.slice(n+1),e.moduleDirs))throw new rt(e,`Invalid mapping: "${t}".`)}const r=new URL(t,e.pkgURL);if(!r.href.startsWith(e.pkgURL.href))throw new rt(e,`Resolved to ${r.href} which is outside package ${e.pkgURL.href}`);if(!o)return r;if(st(o.split(/\/|\\/),e.moduleDirs))throw new nt(e);return r.href.replace(/\*/g,o)}if(Array.isArray(t)){if(0===t.length)return null;let r=null;for(const s of t)try{const t=await it(e,{target:s,patternMatch:o,isImports:n});if(void 0!==t)return t}catch(e){if(!(e instanceof rt))throw e;r=e}if(r)throw r;return null}if(!t||"object"!=typeof t){if(null===t)return null;throw new rt(e,"Invalid exports field.")}for(const[r,s]of Object.entries(t))if("default"===r||e.conditions.includes(r)){const t=await it(e,{target:s,patternMatch:o,isImports:n});if(void 0!==t)return t}}function at(e,t){const o=e.includes("*")?e.indexOf("*")+1:e.length,n=(t.includes("*")?t.indexOf("*")+1:t.length)-o;return 0!==n?n:e.includes("*")?t.includes("*")?t.length-e.length:-1:1}async function lt(e,{matchKey:t,matchObj:o,isImports:n}){if(!t.includes("*")&&t in o){const r=o[t];return await it(e,{target:r,patternMatch:"",isImports:n})}const r=Object.keys(o).filter((e=>e.endsWith("/")||e.includes("*"))).sort(at);for(const s of r){const r=s.indexOf("*"),i=-1===r?s:s.substring(0,r);if(t.startsWith(i)&&t!==i){const a=-1!==r?s.substring(r+1):"";if(0===a.length||t.endsWith(a)&&t.length>=s.length){const r=o[s],l=t.substring(i.length,t.length-a.length);return await it(e,{target:r,patternMatch:l,isImports:n})}}}throw new nt(e,n)}async function ct(e,t,o){if(function(e){const t=Object.keys(e);return t.some((e=>e.startsWith(".")))&&t.some((e=>!e.startsWith(".")))}(o))throw new ot(e,"All keys must either start with ./, or without one.");if("."===t){let t;if("string"==typeof o||Array.isArray(o)||Qe(o)?t=o:Ze(o)&&(t=o["."]),t){const o=await it(e,{target:t,patternMatch:"",isImports:!1});if(o)return o}}else if(Ze(o)){const n=await lt(e,{matchKey:t,matchObj:o,isImports:!1});if(n)return n}throw new nt(e)}const ut=L(U),pt=L(N.readFile);async function dt({importSpecifier:e,packageInfoCache:t,extensions:o,mainFields:n,preserveSymlinks:r,useBrowserOverrides:s,baseDir:i,moduleDirectories:a,modulePaths:l,rootDir:c,ignoreSideEffectsForRoot:u}){let p,d=()=>null,m=!0,f=!1;const h={basedir:i,readFile:Ke,isFile:Je,isDirectory:Be,extensions:o,includeCoreModules:!1,moduleDirectory:a,paths:l,preserveSymlinks:r,packageFilter:(e,i)=>{const a=ze({cache:t,extensions:o,pkg:e,pkgPath:i,mainFields:n,preserveSymlinks:r,useBrowserOverrides:s,rootDir:c,ignoreSideEffectsForRoot:u});return({packageInfo:p,hasModuleSideEffects:d,hasPackageEntry:m,packageBrowserField:f}=a),a.cachedPkg}};let g;try{g=await ut(e,h)}catch(e){if("MODULE_NOT_FOUND"!==e.code)throw e;return null}return{location:r?g:await Ue(g),hasModuleSideEffects:d,hasPackageEntry:m,packageBrowserField:f,packageInfo:p}}async function mt({importer:e,importSpecifier:t,exportConditions:o,packageInfoCache:n,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m,allowExportsFolderMapping:f}){if(t.startsWith("#")){const r=await async function({importSpecifier:e,importer:t,moduleDirs:o,conditions:n,resolveId:r}){const s=await Ve(t,o);if(!s)throw new Error(`${Xe(e,t)}. Could not find a parent package.json.`);const{pkgPath:i,pkgJsonPath:a,pkgJson:l}=s,c={importer:t,importSpecifier:e,moduleDirs:o,pkgURL:b(`${i}/`),pkgJsonPath:a,conditions:n,resolveId:r};if(!e.startsWith("#"))throw new nt(c,!0,"Invalid import specifier.");if("#"===e||e.startsWith("#/"))throw new nt(c,!0,"Invalid import specifier.");const{imports:u}=l;if(!u)throw new nt(c,!0);return lt(c,{matchKey:e,matchObj:u,isImports:!0})}({importSpecifier:t,importer:e,moduleDirs:u,conditions:o,resolveId:e=>dt({importSpecifier:e,packageInfoCache:n,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p})}),d=x(r);return{location:a?d:await Ue(d),hasModuleSideEffects:()=>null,hasPackageEntry:!0,packageBrowserField:!1,packageInfo:void 0}}const h=Ge(t);if(h){let g,y=()=>null,w=!0,v=!1;const E={basedir:c,readFile:Ke,isFile:Je,isDirectory:Be,extensions:s,includeCoreModules:!1,moduleDirectory:u,paths:p,preserveSymlinks:a,packageFilter:(e,t)=>{const o=ze({cache:n,extensions:s,pkg:e,pkgPath:t,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,rootDir:d,ignoreSideEffectsForRoot:m});return({packageInfo:g,hasModuleSideEffects:y,hasPackageEntry:w,packageBrowserField:v}=o),o.cachedPkg}},$=await async function(e,t,o,n){if(e){const o=await Ve(e,n);if(o&&o.pkgJson.name===t)return o}try{const e=await ut(`${t}/package.json`,o);return{pkgJsonPath:e,pkgJson:JSON.parse(await pt(e,"utf-8")),pkgPath:r(e)}}catch(e){return null}}(e,h,E,u);if($&&$.pkgJson.exports){const{pkgJson:n,pkgJsonPath:r}=$,s=h===t?".":`.${t.substring(h.length)}`,i=r.replace("package.json",""),l=b(i),c={importer:e,importSpecifier:t,moduleDirs:u,pkgURL:l,pkgJsonPath:r,allowExportsFolderMapping:f,conditions:o},p=await ct(c,s,n.exports),d=x(p);if(d)return{location:a?d:await Ue(d),hasModuleSideEffects:y,hasPackageEntry:w,packageBrowserField:v,packageInfo:g}}}return null}async function ft({importer:e,importSpecifierList:t,exportConditions:o,warn:n,packageInfoCache:r,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m,allowExportsFolderMapping:f}){try{const n=await mt({importer:e,importSpecifier:t[0],exportConditions:o,packageInfoCache:r,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m,allowExportsFolderMapping:f});if(n)return n}catch(e){if(e instanceof tt)return n(e),null;throw e}return async function({importer:e,importSpecifierList:t,exportConditions:o,warn:n,packageInfoCache:r,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m}){for(let f=0;f<t.length;f++){const h=await dt({importer:e,importSpecifier:t[f],exportConditions:o,warn:n,packageInfoCache:r,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m});if(h)return h}return null}({importer:e,importSpecifierList:t,exportConditions:o,warn:n,packageInfoCache:r,extensions:s,mainFields:i,preserveSymlinks:a,useBrowserOverrides:l,baseDir:c,moduleDirectories:u,modulePaths:p,rootDir:d,ignoreSideEffectsForRoot:m})}const ht=/\^(\d+\.\d+\.\d+)/g;const gt="\0node-resolve:empty.js",yt=e=>{Object.freeze(e);for(const t of Object.values(e))"object"!=typeof t||Object.isFrozen(t)||yt(t);return e},wt=["default","module"],vt=[...wt,"import"],xt=[...wt,"require"],bt={dedupe:[],extensions:[".mjs",".js",".json",".node"],resolveOnly:[],moduleDirectories:["node_modules"],modulePaths:[],ignoreSideEffectsForRoot:!1,allowExportsFolderMapping:!0},Et=/^node:/;function $t(e={}){const{warnings:t}=function(e){const t=[];if(e.customResolveOptions){const{customResolveOptions:o}=e;if(o.moduleDirectory&&(e.moduleDirectories=Array.isArray(o.moduleDirectory)?o.moduleDirectory:[o.moduleDirectory],t.push("node-resolve: The `customResolveOptions.moduleDirectory` option has been deprecated. Use `moduleDirectories`, which must be an array.")),o.preserveSymlinks)throw new Error("node-resolve: `customResolveOptions.preserveSymlinks` is no longer an option. We now always use the rollup `preserveSymlinks` option.");["basedir","package","extensions","includeCoreModules","readFile","isFile","isDirectory","realpath","packageFilter","pathFilter","paths","packageIterator"].forEach((e=>{if(o[e])throw new Error(`node-resolve: \`customResolveOptions.${e}\` is no longer an option. If you need this, please open an issue.`)}))}return{warnings:t}}(e),o={...bt,...e},{extensions:n,jail:l,moduleDirectories:c,modulePaths:u,ignoreSideEffectsForRoot:p}=o,d=o.exportConditions||[],m=d.includes("development")||d.includes("production")?[]:[process.env.NODE_ENV&&"production"!==process.env.NODE_ENV?"development":"production"],f=[...vt,...d,...m],h=[...xt,...d,...m],g=new Map,y=new Map,w=function(e){let t;if(e.mainFields?({mainFields:t}=e):t=["module","main"],e.browser&&-1===t.indexOf("browser"))return["browser"].concat(t);if(!t.length)throw new Error("Please ensure at least one `mainFields` value is specified");return t}(o),v=-1!==w.indexOf("browser"),x=Object.prototype.hasOwnProperty.call(o,"preferBuiltins"),b=!x||o.preferBuiltins,E=s(o.rootDir||process.cwd());let S,{dedupe:j}=o;if(c.some((e=>e.includes("/"))))throw new Error("`moduleDirectories` option must only contain directory names. If you want to load modules from somewhere not supported by the default module resolution algorithm, see `modulePaths`.");"function"!=typeof j&&(j=e=>o.dedupe.includes(e)||o.dedupe.includes(Ge(e)));const k="function"==typeof o.resolveOnly?o.resolveOnly:(e=>{const t=e.map((e=>{if(e instanceof RegExp)return e;const t=e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&");return new RegExp(`^${t}$`)}));return e=>!t.length||t.some((t=>t.test(e)))})(o.resolveOnly),_=new Map;let O;const F=async(e,t,d,m)=>{const[F,D]=t.split("?"),I=""+(D?`?${D}`:"");t=F;const N=!d||j(t)?E:r(d),C=_.get(d);if(v&&C){const e=s(N,t);if(!1===C[t]||!1===C[e])return{id:gt};const o="."!==t[0]&&C[t]||C[e]||C[`${e}.js`]||C[`${e}.json`];o&&(t=o)}const R=t.split(/[/\\]/);let M=R.shift(),A=!1;if("@"===M[0]&&R.length>0?M+=`/${R.shift()}`:"."===M[0]&&(M=s(N,t),A=!0),!A&&!k(M))return!!(T=S.input,Array.isArray(T)?T:"object"==typeof T?Object.values(T):[T]).includes(t)&&null;var T;const q=[t];if(void 0!==d||t[0].match(/^\.?\.?\//)||q.push(`./${t}`),d&&/\.(ts|mts|cts|tsx)$/.test(d))for(const[e,o]of[[".js",".ts"],[".js",".tsx"],[".jsx",".tsx"],[".mjs",".mts"],[".cjs",".cts"]])t.endsWith(e)&&n.includes(o)&&q.push(t.slice(0,-e.length)+o);const L=m&&m["node-resolve"]&&m["node-resolve"].isRequire?h:f;v&&!L.includes("browser")&&L.push("browser");const U=await ft({importer:d,importSpecifierList:q,exportConditions:L,warn:(...t)=>e.warn(...t),packageInfoCache:g,extensions:n,mainFields:w,preserveSymlinks:O,useBrowserOverrides:v,baseDir:N,moduleDirectories:c,modulePaths:u,rootDir:E,ignoreSideEffectsForRoot:p,allowExportsFolderMapping:o.allowExportsFolderMapping}),W=$.includes(t.replace(Et,"")),H="function"==typeof b?b(t):b,B=W&&H?{packageInfo:void 0,hasModuleSideEffects:()=>null,hasPackageEntry:!0,packageBrowserField:!1}:U;if(!B)return null;const{packageInfo:J,hasModuleSideEffects:K,hasPackageEntry:G,packageBrowserField:z}=B;let{location:Y}=B;if(z){if(Object.prototype.hasOwnProperty.call(z,Y)){if(!z[Y])return _.set(Y,z),{id:gt};Y=z[Y]}_.set(Y,z)}if(G&&!O){await Le(Y)&&(Y=await Te(Y))}if(y.set(Y,J),G){if(W&&H)return!x&&U&&B!==t&&e.warn({message:`preferring built-in module '${t}' over local alternative at '${U.location}', pass 'preferBuiltins: false' to disable this behavior or 'preferBuiltins: true' to disable this warning.or passing a function to 'preferBuiltins' to provide more fine-grained control over which built-in modules to prefer.`,pluginCode:"PREFER_BUILTINS"}),!1;if(l&&0!==Y.indexOf(i(l.trim(a))))return null}if(o.modulesOnly&&await Le(Y)){const e=await Ae(Y,"utf-8");return P(e)?{id:`${Y}${I}`,moduleSideEffects:K(Y)}:null}return{id:`${Y}${I}`,moduleSideEffects:K(Y)}};return{name:"node-resolve",version:"16.0.1",buildStart(e){!function(e,t){let o,n=1/0,r=1/0,s=1/0;for(;o=ht.exec(t);){const[e,t,i]=o[1].split(".").map(Number);e<n&&(n=e,r=t,s=i)}if(!e)throw new Error(`Insufficient Rollup version: "@rollup/plugin-node-resolve" requires at least rollup@${n}.${r}.${s}.`);const[i,a,l]=e.split(".").map(Number);if(i<n||i===n&&(a<r||a===r&&l<s))throw new Error(`Insufficient rollup version: "@rollup/plugin-node-resolve" requires at least rollup@${n}.${r}.${s} but found rollup@${e}.`)}(this.meta.rollupVersion,Me),S=e;for(const e of t)this.warn(e);({preserveSymlinks:O}=e)},generateBundle(){Ke.clear(),Je.clear(),Be.clear()},resolveId:{order:"post",async handler(e,t,o){if(e===gt)return e;if(e&&e.includes("\0"))return null;const{custom:n={}}=o,{"node-resolve":{resolved:r}={}}=n;if(r)return r;t&&t.includes("\0")&&(t=void 0);const s=await F(this,e,t,n);if(s){const r=await this.resolve(s.id,t,{...o,skipSelf:!1,custom:{...n,"node-resolve":{...n["node-resolve"],resolved:s,importee:e}}});if(r)return!r.external&&(r.id!==s.id?r:{...s,meta:r.meta})}return s}},load:e=>e===gt?"export default {};":null,getPackageInfoForId:e=>y.get(e)}}yt(I({},bt));var St="^2.68.0||^3.0.0||^4.0.0";function jt(e,t,o){try{return e(t,{allowReturnOutsideFunction:!0})}catch(e){throw e.message+=` in ${o}`,e}}const kt=/\b(?:require|module|exports|global)\b/,_t=/\b(?:require|module|exports)\b/;function Ot(e,t,o){let n=1,r=k(o);for(;e.some((e=>e.contains(r)))||t.has(r);)r=k(`${o}_${n}`),n+=1;for(const t of e)t.declarations[r]=!0;return r}function Ft(e){const t=k(u(e,l(e)));return"index"!==t?t:k(u(r(e)))}function Dt(e){return e.replace(/\\/g,"/")}const It=(e,t)=>`/${Dt(c(t,e))}`;function Pt(e){return e[0].toUpperCase()+e.slice(1)}function Nt(e){let t="index.js";try{R(p(e,"package.json"))&&(t=JSON.parse(M(p(e,"package.json"),{encoding:"utf8"})).main||t)}catch(e){}return t}function Ct(e){try{if(A(e).isDirectory())return!0}catch(e){}return!1}const Rt="throw new Error('Could not dynamically require \"' + path + '\". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');",Mt="commonjsRequire",At="createCommonjsRequire";const Tt=(e,t)=>e.endsWith(t),qt=(e,t)=>`\0${e}${t}`,Lt=(e,t)=>e.slice(1,-t.length),Ut="?commonjs-proxy",Wt="?commonjs-wrapped",Ht="?commonjs-external",Bt="?commonjs-exports",Jt="?commonjs-module",Kt="?commonjs-entry",Gt="?commonjs-es-import",zt="\0commonjs-dynamic-modules",Yt="\0commonjsHelpers.js",Vt="withRequireFunction";function Qt(e,t){if(!0===t||e.endsWith(".json"))return`export { default } from ${JSON.stringify(e)};`;const o=Ft(e),n="auto"===t?`import { getDefaultExportFromNamespaceIfNotNamed } from "${Yt}"; export default /*@__PURE__*/getDefaultExportFromNamespaceIfNotNamed(${o});`:"preferred"===t?`import { getDefaultExportFromNamespaceIfPresent } from "${Yt}"; export default /*@__PURE__*/getDefaultExportFromNamespaceIfPresent(${o});`:t?`export default ${o};`:`import { getAugmentedNamespace } from "${Yt}"; export default /*@__PURE__*/getAugmentedNamespace(${o});`;return`import * as ${o} from ${JSON.stringify(e)}; ${n}`}function Zt(e,t,o){const n=Ft(e),r=`${n}Exports`,s=`require${Pt(n)}`;let i=`import { getDefaultExportFromCjs } from "${Yt}";\nimport { __require as ${s} } from ${JSON.stringify(e)};\nvar ${r} = ${o?"":"/*@__PURE__*/ "}${s}();\nexport { ${r} as __moduleExports };`;return i+=!0===t?`\nexport { ${r} as default };`:!1===t?`\nexport default ${r}.default;`:`\nexport default /*@__PURE__*/getDefaultExportFromCjs(${r});`,{code:i,syntheticNamedExports:"__moduleExports"}}function Xt(e,t){return t.reduce(((t,o)=>t.concat(function(e,t){return[e+t,`${e}${a}index${t}`]}(e,o))),[e])}function eo(e,t,o){if("."!==e[0]||!t)return;const n=Xt(s(r(t),e),o);for(let e=0;e<n.length;e+=1)try{if(A(n[e]).isFile())return{id:n[e]}}catch(e){}}function to(e,t,o){const n=/\^(\d+\.\d+\.\d+)/g;let r,s=1/0,i=1/0,a=1/0;for(;r=n.exec(t);){const[e,t,o]=r[1].split(".").map(Number);e<s&&(s=e,i=t,a=o)}if(!e)throw new Error(`Insufficient ${o} version: "@rollup/plugin-commonjs" requires at least ${o}@${s}.${i}.${a}.`);const[l,c,u]=e.split(".").map(Number);if(l<s||l===s&&(c<i||c===i&&u<a))throw new Error(`Insufficient ${o} version: "@rollup/plugin-commonjs" requires at least ${o}@${s}.${i}.${a} but found ${o}@${e}.`)}const oo={"==":e=>ro(e.left,e.right,!1),"!=":e=>no(oo["=="](e)),"===":e=>ro(e.left,e.right,!0),"!==":e=>no(oo["==="](e)),"!":e=>io(e.argument),"&&":e=>so(e.left)&&so(e.right),"||":e=>so(e.left)||so(e.right)};function no(e){return null===e?e:!e}function ro(e,t,o){return e.type!==t.type?null:"Literal"===e.type?o?e.value===t.value:e.value==t.value:null}function so(e){return!!e&&("Literal"===e.type?!!e.value:"ParenthesizedExpression"===e.type?so(e.expression):e.operator in oo?oo[e.operator](e):null)}function io(e){return no(so(e))}function ao(e){const t=[];for(;"MemberExpression"===e.type;){if(e.computed)return null;t.unshift(e.property.name),e=e.object}if("Identifier"!==e.type)return null;const{name:o}=e;return t.unshift(o),{name:o,keypath:t.join(".")}}const lo="__esModule";function co(e,t){const{callee:{object:o,property:n}}=e;if(!o||"Identifier"!==o.type||"Object"!==o.name)return;if(!n||"Identifier"!==n.type||"defineProperty"!==n.name)return;if(3!==e.arguments.length)return;const r=t.split("."),[s,i,a]=e.arguments;if(1===r.length&&("Identifier"!==s.type||s.name!==r[0]))return;if(2===r.length&&("MemberExpression"!==s.type||s.object.name!==r[0]||s.property.name!==r[1]))return;if("ObjectExpression"!==a.type||!a.properties)return;const l=a.properties.find((e=>e.key&&"value"===e.key.name));return l&&l.value?{key:i.value,value:l.value}:void 0}function uo(e,t,o,n,r,s,i,a,l,c,u,p,d,m,f,h,g){const y=[],w=[];return h?function(e,t,o,n,r,s,i,a,l,c){if(n.push(`${l} as __require`),t)return;if("replace"===o)mo(e,r,a);else{mo(e,r,`${i}.exports`);for(const[t,{nodes:n}]of s)for(const{node:r,type:s}of n)e.overwrite(r.start,r.left.end,`${"module"===o&&"module"===s?`${i}.exports`:a}.${t}`);fo(c,e,o,i,a)}}(e,r,m,y,s,a,t,o,g,c):"replace"===m?function(e,t,o,n,r,s,i,a){for(const{left:t}of n)e.overwrite(t.start,t.end,s);e.prependRight(r.left.start,"var "),t.push(`${s} as __moduleExports`),o.push(po(s,i,a))}(e,y,w,s,i,o,f,d):("module"===m?(w.push(`var ${n} = ${t}.exports`),y.push(`${n} as __moduleExports`)):y.push(`${o} as __moduleExports`),r?w.push(po(n,f,d)):function(e,t,o,n,r,s,i,a,l,c,u,p,d,m){let f;for(const{left:t}of n)e.overwrite(t.start,t.end,`${a}.exports`);for(const[o,{nodes:n}]of r){const r=s[o];let c=!0;for(const{node:t,type:s}of n){let n=`${r} = ${"module"===m&&"module"===s?`${a}.exports`:l}.${o}`;c&&i.has(t)&&(n=`var ${n}`,c=!1),e.overwrite(t.start,t.left.end,n)}c&&e.prepend(`var ${r};\n`),"default"===o?f=r:t.push(o===r?o:`${r} as ${o}`)}const h=fo(u,e,m,a,l);!1===d||"auto"===d&&h&&0===n.length?t.push(`${f||c} as default`):!0===d||!h&&0===n.length?t.push(`${c} as default`):o.push(po(c,d,p))}(e,y,w,s,a,u,l,t,o,n,c,d,f,m)),y.length&&w.push(`export { ${y.join(", ")} }`),`\n\n${w.join(";\n")};`}function po(e,t,o){return`export default ${!0===t?e:!1===t?`${e}.default`:`/*@__PURE__*/${o}.getDefaultExportFromCjs(${e})`}`}function mo(e,t,o){for(const{left:n}of t)e.overwrite(n.start,n.end,o)}function fo(e,t,o,n,r){let s=!1;for(const{node:i,type:a}of e){s=!0;const e="CallExpression"===i.type?i.arguments[0]:i.left.object;t.overwrite(e.start,e.end,"module"===o&&"module"===a?`${n}.exports`:r)}return s}function ho(e,t){return"Identifier"===e.type&&"require"===e.name&&!t.contains("require")||"MemberExpression"===e.type&&go(e,t)}function go({object:e,property:t},o){return"Identifier"===e.type&&"module"===e.name&&"Identifier"===t.type&&"require"===t.name&&!o.contains("module")}const yo={resolve:!0,cache:!0,main:!0};function wo(){const e=[];return{addRequireExpression:function(t,o,n,r,s,i,a){e.push({sourceId:t,node:o,scope:n,usesReturnValue:r,isInsideTryBlock:s,isInsideConditional:i,toBeRemoved:a})},rewriteRequireExpressionsAndGetImportBlock:async function(t,o,n,r,s,i,a,l,c,u,p,d,m,f,h){const g=[];g.push(`import * as ${r} from "${Yt}"`),s&&g.push(`import { ${m?At:Mt} as ${s} } from "${zt}"`),"module"===c?g.push(`import { __module as ${i} } from ${JSON.stringify(qt(l,Jt))}`,`var ${a} = ${i}.exports`):"exports"===c&&g.push(`import { __exports as ${a} } from ${JSON.stringify(qt(l,Bt))}`);const y=function(e){const t=Object.create(null);for(const o of e){const{sourceId:e}=o;t[e]||(t[e]=[]);t[e].push(o)}return t}(e),w=await u(l,p?Vt:!d,h,Object.keys(y).map((e=>({source:e,isConditional:y[e].every((e=>e.isInsideConditional))}))));return function(e,t,o,n,r){const s=function(){let e=0;return t=>{let o;const n=({scope:e})=>e.contains(o);do{o=`require$$${e}`,e+=1}while(t.some(n));return o}}();for(const{source:i,id:a,isCommonJS:l,wrappedModuleSideEffects:c}of t){const t=o[i],u=s(t);let p=!1,d=!1;for(const{node:e,usesReturnValue:o,toBeRemoved:s,isInsideTryBlock:m}of t){const{canConvertRequire:t,shouldRemoveRequire:f}=m&&Tt(a,Ht)?n(i):{canConvertRequire:!0,shouldRemoveRequire:!1};f?o?r.overwrite(e.start,e.end,"undefined"):r.remove(s.start,s.end):t&&(d=!0,l===Vt?r.overwrite(e.start,e.end,`${c?"":"/*@__PURE__*/ "}${u}()`):o?(p=!0,r.overwrite(e.start,e.end,u)):r.remove(s.start,s.end))}d&&(l===Vt?e.push(`import { __require as ${u} } from ${JSON.stringify(a)}`):e.push(`import ${p?`${u} from `:""}${JSON.stringify(a)}`))}}(g,w,y,f,t),g.length?`${g.join(";\n")};\n\n`:""}}}const vo=/^(?:module\.)?exports(?:\.([a-zA-Z_$][a-zA-Z_$0-9]*))?$/,xo=/^(?:FunctionDeclaration|FunctionExpression|ArrowFunctionExpression)$/;async function bo(e,t,o,n,s,i,a,l,c,u,p,d,m,f,h,g,y,w,v){const x=m||jt(e,t,o),b=new J(t),E={module:!1,exports:!1,global:!1,require:!1},$=u&&It(r(o),d);let S=_(x,"scope"),j=0,k=0,F=0,D=null,I=!1;const P=new Set;let N=null;const C=new Set,{addRequireExpression:R,rewriteRequireExpressionsAndGetImportBlock:M}=wo(),A=new Set,T=[],q=new Set,L=new Set([S]),U=new Set([S]),W=[];let H=null;const G=new Map,z=new Set,Y=[],V=[],Q=[],Z=[],X=new Set,ee=[];B(x,{enter(e,t){if(q.has(e))this.skip();else switch(null!==D&&e.start>D&&(D=null),null!==N&&e.start>N&&(N=null),null===N&&C.has(e)&&(N=e.end),k+=1,e.scope&&({scope:S}=e),xo.test(e.type)&&(j+=1),c&&(b.addSourcemapLocation(e.start),b.addSourcemapLocation(e.end)),e.type){case"AssignmentExpression":if("MemberExpression"===e.left.type){const t=ao(e.left);if(!t||S.contains(t.name))return;const o=vo.exec(t.keypath);if(!o||"exports"===t.keypath)return;const[,n]=o;if(E[t.name]=!0,"module.exports"===t.keypath)W.push(e),k>3?L.add(S):H||(H=e);else if(n===lo)k>3?I=!0:Y.push({node:e,type:t.name});else{const o=G.get(n)||{nodes:[],scopes:new Set};o.nodes.push({node:e,type:t.name}),o.scopes.add(S),U.add(S),G.set(n,o),k<=3&&z.add(e)}q.add(e.left)}else for(const t of O(e.left))A.add(t);return;case"CallExpression":{const o=function(e){const t=co(e,"exports"),o=t||co(e,"module.exports");return!(!o||o.key!==lo)&&!!so(o.value)&&(t?"exports":"module")}(e);if(o)return void(3===k&&"ExpressionStatement"===t.type?(q.add(e.arguments[0]),Y.push({node:e,type:o})):I=!0);if(u&&e.callee.object&&ho(e.callee.object,S)&&"resolve"===e.callee.property.name){w(e.start),E.require=!0;const t=e.callee.object;return Z.push(t),void q.add(e.callee)}if(!function(e,t){return!!e&&"CallExpression"===e.type&&0!==e.arguments.length&&ho(e.callee,t)}(e,S)){const t=ao(e.callee);return void(t&&X.has(t.name)&&(N=1/0))}if(q.add(e.callee),E.require=!0,function(e){return e.arguments.length>1||"Literal"!==e.arguments[0].type&&("TemplateLiteral"!==e.arguments[0].type||e.arguments[0].expressions.length>0)}(e))return u&&w(e.start),void(a||Z.push(e.callee));const n=function(e){return"Literal"===e.arguments[0].type?e.arguments[0].value:e.arguments[0].quasis[0].value.cooked}(e);if(!i(n)){const o="ExpressionStatement"!==t.type,r="ExpressionStatement"===t.type&&(!N||null!==D&&D<N)?t:e;if(R(n,e,S,o,null!==D,null!==N,r),"VariableDeclarator"===t.type&&"Identifier"===t.id.type)for(const e of O(t.id))X.add(e)}return}case"ClassBody":return void(F+=1);case"ConditionalExpression":case"IfStatement":return void(io(e.test)?q.add(e.consequent):so(e.test)?e.alternate&&q.add(e.alternate):(C.add(e.consequent),e.alternate&&C.add(e.alternate)));case"ArrowFunctionExpression":case"FunctionDeclaration":case"FunctionExpression":return void(null!==N||"CallExpression"===t.type&&t.callee===e||(N=e.end));case"Identifier":{const{name:o}=e;if(!K(e,t)||S.contains(o)||"PropertyDefinition"===t.type&&t.key===e)return;switch(o){case"require":if(E.require=!0,function(e){return e&&e.property&&yo[e.property.name]}(t))return;return void(a||(function(e){return e&&"Property"===e.type&&e.shorthand}(t)&&(q.add(t.value),b.prependRight(e.start,"require: ")),Z.push(e)));case"module":case"exports":return I=!0,void(E[o]=!0);case"global":return E.global=!0,void(s||V.push(e));case"define":return void b.overwrite(e.start,e.end,"undefined",{storeName:!0});default:return void P.add(o)}}case"LogicalExpression":return void("&&"===e.operator?io(e.left)?q.add(e.right):so(e.left)||C.add(e.right):"||"===e.operator&&(so(e.left)?q.add(e.right):io(e.left)||C.add(e.right)));case"MemberExpression":return void(!u&&go(e,S)&&(E.require=!0,Z.push(e),q.add(e.object),q.add(e.property)));case"ReturnStatement":return void(0===j&&(I=!0));case"ThisExpression":return void(0!==j||F||(E.global=!0,s||Q.push(e)));case"TryStatement":return null===D&&(D=e.block.end),void(null===N&&(N=e.end));case"UnaryExpression":if("typeof"===e.operator){const t=ao(e.argument);if(!t)return;if(S.contains(t.name))return;n||"module.exports"!==t.keypath&&"module"!==t.keypath&&"exports"!==t.keypath||b.overwrite(e.start,e.end,"'object'",{storeName:!1})}return;case"VariableDeclaration":return void(S.parent||T.push(e));case"TemplateElement":e.value.raw.includes("\n")&&ee.push([e.start,e.end])}},leave(e){k-=1,e.scope&&(S=S.parent),xo.test(e.type)&&(j-=1),"ClassBody"===e.type&&(F-=1)}});const te=Ft(o),oe=Ot([...U],P,te),ne=Ot([...L],P,`${te}Module`),re=Ot([S],P,`require${Pt(te)}`),se=Ot([S],P,`hasRequired${Pt(te)}`),ie=Ot([S],P,"commonjsHelpers"),ae=Z.length>0&&Ot([S],P,u?At:Mt),le=Object.create(null);for(const[e,{scopes:t}]of G)le[e]=Ot([...t],P,e);for(const e of V)b.overwrite(e.start,e.end,`${ie}.commonjsGlobal`,{storeName:!0});for(const e of Q)b.overwrite(e.start,e.end,oe,{storeName:!0});for(const e of Z)b.overwrite(e.start,e.end,u?`${ae}(${JSON.stringify($)})`:ae,{contentOnly:!0,storeName:!0});if(I=!n&&(I||E.exports&&W.length>0),!(I||y||h||E.module||E.exports||E.require||Y.length>0)&&(s||!E.global))return{meta:{commonjs:{isCommonJS:!1}}};let ce="";if(t.startsWith("/*")){const e=t.indexOf("*/",2)+2;ce=`${t.slice(0,e)}\n`,b.remove(0,e).trim()}let ue="";if(t.startsWith("#!")){const e=t.indexOf("\n")+1;ue=t.slice(0,e),b.remove(0,e).trim()}const pe=n?"none":I?E.module?"module":"exports":H?0===G.size&&0===Y.length?"replace":"module":0===W.length?"exports":"module",de="module"===pe?Ot([],P,`${te}Exports`):oe,me=await M(b,T,A,ie,ae,ne,oe,o,pe,g,h,n,u,l,v),fe=v.isCommonJS===Vt,he=n?"":uo(b,ne,oe,de,I,W,H,G,z,Y,le,0,ie,pe,f,fe,re);if(I&&function(e,t,o,n,r){const s=[],i=[];t.module&&(s.push("module"),i.push(o)),t.exports&&(s.push("exports"),i.push(t.module?`${o}.exports`:n)),e.trim().indent("\t",{exclude:r}).prepend(`(function (${s.join(", ")}) {\n`).append(` \n} (${i.join(", ")}));`)}(b,E,ne,oe,ee),fe){b.trim().indent("\t",{exclude:ee});const e="module"===pe?`${ne}.exports`:oe;b.prepend(`var ${se};\n\nfunction ${re} () {\n\tif (${se}) return ${e};\n\t${se} = 1;\n`).append(`\n\treturn ${e};\n}`),"replace"===pe&&b.prepend(`var ${oe};\n`)}return b.trim().prepend(ue+ce+me).append(he),{code:b.toString(),map:c?b.generateMap():null,syntheticNamedExports:!n&&!fe&&"__moduleExports",meta:{commonjs:{...v,shebang:ue}}}}function Eo(e={}){const{ignoreGlobal:t,ignoreDynamicRequires:o,requireReturnsDefault:n,defaultIsModuleExports:i,esmExternals:a}=e,u=e.extensions||[".js"],d=j(e.include,e.exclude),m=e=>{const t=l(e);return".cjs"===t||u.includes(t)&&d(e)},{strictRequiresFilter:f,detectCyclesAndConditional:h}=function({strictRequires:e}){switch(e){case void 0:case!0:return{strictRequiresFilter:()=>!0,detectCyclesAndConditional:!1};case"auto":case"debug":case null:return{strictRequiresFilter:()=>!1,detectCyclesAndConditional:!0};case!1:return{strictRequiresFilter:()=>!1,detectCyclesAndConditional:!1};default:if("string"==typeof e||Array.isArray(e))return{strictRequiresFilter:j(e),detectCyclesAndConditional:!1};throw new Error('Unexpected value for "strictRequires" option.')}}(e),g="function"==typeof n?n:()=>n;let y;const w="function"==typeof a?a:Array.isArray(a)?(y=new Set(a),e=>y.has(e)):()=>a,v="function"==typeof i?i:()=>"boolean"==typeof i?i:"auto",x="string"==typeof e.dynamicRequireRoot?s(e.dynamicRequireRoot):process.cwd(),{commonDir:b,dynamicRequireModules:E}=function(e,t){const o=new Map,n=new Set;for(const t of!e||Array.isArray(e)?e||[]:[e]){const e=t.startsWith("!"),i=(t,n)=>e?o.delete(t):o.set(t,n);for(const o of(new H).withBasePath().withDirs().glob(e?t.substr(1):t).crawl().sync().sort(((e,t)=>e.localeCompare(t,"en")))){const e=s(o),t=Dt(e);if(Ct(e)){n.add(e);const r=s(p(e,Nt(o)));i(t,r),i(Dt(r),r)}else n.add(r(e)),i(t,e)}}return{commonDir:n.size?W([...n,t]):null,dynamicRequireModules:o}}(e.dynamicRequireTargets,x),$=E.size>0,S="function"==typeof e.ignore?e.ignore:Array.isArray(e.ignore)?t=>e.ignore.includes(t):()=>!1,k=t=>{const o="function"==typeof e.ignoreTryCatch?e.ignoreTryCatch(t):Array.isArray(e.ignoreTryCatch)?e.ignoreTryCatch.includes(t):void 0===e.ignoreTryCatch||e.ignoreTryCatch;return{canConvertRequire:"remove"!==o&&!0!==o,shouldRemoveRequire:"remove"===o}},{currentlyResolving:_,resolveId:O}=function(e,t){const o=new Map;return{currentlyResolving:o,async resolveId(n,r,s){const i=s.custom;if(i?.["node-resolve"]?.isRequire)return null;const a=o.get(r);if(a&&a.has(n))return this.warn({code:"THIS_RESOLVE_WITHOUT_OPTIONS",message:'It appears a plugin has implemented a "resolveId" hook that uses "this.resolve" without forwarding the third "options" parameter of "resolveId". This is problematic as it can lead to wrong module resolutions especially for the node-resolve plugin and in certain cases cause early exit errors for the commonjs plugin.\nIn rare cases, this warning can appear if the same file is both imported and required from the same mixed ES/CommonJS module, in which case it can be ignored.',url:"https://rollupjs.org/guide/en/#resolveid"}),null;if(Tt(n,Wt))return Lt(n,Wt);if(n.endsWith(Kt)||Tt(n,Jt)||Tt(n,Bt)||Tt(n,Ut)||Tt(n,Gt)||Tt(n,Ht)||n.startsWith(Yt)||n===zt)return n;if(r){if(r===zt||Tt(r,Ut)||Tt(r,Gt)||r.endsWith(Kt))return n;if(Tt(r,Ht))return await this.resolve(n,r,Object.assign({skipSelf:!0},s))?{id:n,external:!0}:null}if(n.startsWith("\0"))return null;const l=await this.resolve(n,r,Object.assign({skipSelf:!0},s))||eo(n,r,e);if(!l||l.external||l.id.endsWith(Kt)||Tt(l.id,Gt)||!t(l.id))return l;const c=await this.load(l),{meta:{commonjs:u}}=c;if(u){const{isCommonJS:e}=u;if(e){if(s.isEntry)return c.moduleSideEffects=!0,l.id+Kt;if(e===Vt)return{id:qt(l.id,Gt),meta:{commonjs:{resolved:l}}}}}return l}}}(u,m),F=!1!==e.sourceMap;let D;function I(n,s){const i=Dt(s),{isEsModule:a,hasDefaultExport:l,hasNamedExports:c,ast:u}=function(e,t,o){const n=jt(e,t,o);let r=!1,s=!1,i=!1;for(const e of n.body)switch(e.type){case"ExportDefaultDeclaration":r=!0,s=!0;break;case"ExportNamedDeclaration":if(r=!0,e.declaration)i=!0;else for(const t of e.specifiers)"default"===t.exported.name?s=!0:i=!0;break;case"ExportAllDeclaration":r=!0,e.exported&&"default"===e.exported.name?s=!0:i=!0;break;case"ImportDeclaration":r=!0}return{isEsModule:r,hasDefaultExport:s,hasNamedExports:i,ast:n}}(this.parse,n,s),p=this.getModuleInfo(s).meta.commonjs||{};if(l&&(p.hasDefaultExport=!0),c&&(p.hasNamedExports=!0),!E.has(i)&&(!function(e,t){return(t?_t:kt).test(e)}(n,t)&&!D.isRequiredId(s)||a&&!e.transformMixedEsModules))return p.isCommonJS=!1,{meta:{commonjs:p}};const d=!a&&(E.has(i)||f(s));return bo(this.parse,n,s,a,t||a,S,o&&!$,k,F,$,0,b,u,v(s),d,D.resolveRequireSourcesAndUpdateMeta(this),D.isRequiredId(s),(e=>{const t=Dt(x);0!==i.indexOf(t)&&this.error({code:"DYNAMIC_REQUIRE_OUTSIDE_ROOT",normalizedId:i,normalizedDynamicRequireRoot:t,message:`"${i}" contains dynamic require statements but it is not within the current dynamicRequireRoot "${t}". You should set dynamicRequireRoot to "${r(i)}" or one of its parent directories.`},e)}),p)}return{name:"commonjs",version:"28.0.3",options(e){const t=Array.isArray(e.plugins)?[...e.plugins]:e.plugins?[e.plugins]:[];return t.unshift({name:"commonjs--resolver",resolveId:O}),{...e,plugins:t}},buildStart({plugins:t}){to(this.meta.rollupVersion,St,"rollup");const o=t.find((({name:e})=>"node-resolve"===e));o&&to(o.version,"^13.0.6","@rollup/plugin-node-resolve"),null!=e.namedExports&&this.warn('The namedExports option from "@rollup/plugin-commonjs" is deprecated. Named exports are now handled automatically.'),D=function(e,t,o){const n=Object.create(null),r=Object.create(null),s=Object.create(null),i=Object.create(null),a=e=>i[e]||(i[e]=new Set),l=e=>{const t=new Set(a(e));for(const o of t){if(o===e)return!0;for(const e of a(o))t.add(e)}return!1},c=Object.create(null),u=e=>{const o=n[e];return!0!==o||!t||c[e]?o:l(e)?n[e]=Vt:o},p=(e,o)=>{c[e]||(n[e]=o,t&&!0===n[e]&&r[e]&&!s[e]&&(n[e]=Vt))},d=async(e,t,o,i)=>{const c=t.id;r[c]=!0,o||n[e]===Vt||(s[c]=!0),a(e).add(c),l(c)||await i(t)},m=async(e,t)=>{if(e.id in n)return n[e.id];const{meta:{commonjs:o}}=await t(e);return o&&o.isCommonJS||!1};return{getWrappedIds:()=>Object.keys(n).filter((e=>n[e]===Vt)),isRequiredId:e=>r[e],async shouldTransformCachedModule({id:e,resolvedSources:t,meta:{commonjs:o}}){if(o&&o.isCommonJS||(n[e]=!1),Tt(e,Gt))return!1;const r=o&&o.requires;if(r){if(p(e,o.initialCommonJSType),await Promise.all(r.map((({resolved:t,isConditional:o})=>d(e,t,o,this.load)))),u(e)!==o.isCommonJS)return!0;for(const{resolved:{id:e}}of r)if(u(e)!==o.isRequiredCommonJS[e])return!0;c[e]=!0;for(const{resolved:{id:e}}of r)c[e]=!0}const s=new Set((r||[]).map((({resolved:{id:e}})=>e)));return(await Promise.all(Object.keys(t).map((e=>t[e])).filter((({id:e,external:t})=>!(t||s.has(e)))).map((async e=>Tt(e.id,Gt)?await m((await this.load({id:e.id})).meta.commonjs.resolved,this.load)!==Vt:await m(e,this.load)===Vt)))).some((e=>e))},resolveRequireSourcesAndUpdateMeta:t=>async(n,r,s,i)=>{s.initialCommonJSType=r,s.requires=[],s.isRequiredCommonJS=Object.create(null),p(n,r);const a=o.get(n)||new Set;o.set(n,a);const l=await Promise.all(i.map((async({source:o,isConditional:r})=>{if(o.startsWith("\0"))return{id:o,allowProxy:!1};a.add(o);const i=await t.resolve(o,n,{skipSelf:!1,custom:{"node-resolve":{isRequire:!0}}})||eo(o,n,e);if(a.delete(o),!i)return{id:qt(o,Ht),allowProxy:!1};const l=i.id;return i.external?{id:qt(l,Ht),allowProxy:!1}:(s.requires.push({resolved:i,isConditional:r}),await d(n,i,r,t.load),{id:l,allowProxy:!0})})));return s.isCommonJS=u(n),c[n]=!0,l.map((({id:e,allowProxy:o},n)=>{const r=s.isRequiredCommonJS[e]=u(e),a=r===Vt;return c[e]=!0,{wrappedModuleSideEffects:a&&t.getModuleInfo(e).moduleSideEffects,source:i[n].source,id:o?qt(e,a?Wt:Ut):e,isCommonJS:r}}))},isCurrentlyResolving(e,t){const n=o.get(t);return n&&n.has(e)}}}(u,h,_)},buildEnd(){if("debug"===e.strictRequires){const e=D.getWrappedIds();e.length?this.warn({code:"WRAPPED_IDS",ids:e,message:`The commonjs plugin automatically wrapped the following files:\n[\n${e.map((e=>`\t${JSON.stringify(c(process.cwd(),e))}`)).join(",\n")}\n]`}):this.warn({code:"WRAPPED_IDS",ids:e,message:"The commonjs plugin did not wrap any files."})}},async load(e){if(e===Yt)return"\nexport var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nexport function getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nexport function getDefaultExportFromNamespaceIfPresent (n) {\n\treturn n && Object.prototype.hasOwnProperty.call(n, 'default') ? n['default'] : n;\n}\n\nexport function getDefaultExportFromNamespaceIfNotNamed (n) {\n\treturn n && Object.prototype.hasOwnProperty.call(n, 'default') && Object.keys(n).length === 1 ? n['default'] : n;\n}\n\nexport function getAugmentedNamespace(n) {\n  if (Object.prototype.hasOwnProperty.call(n, '__esModule')) return n;\n  var f = n.default;\n\tif (typeof f == \"function\") {\n\t\tvar a = function a () {\n\t\t\tif (this instanceof a) {\n        return Reflect.construct(f, arguments, this.constructor);\n\t\t\t}\n\t\t\treturn f.apply(this, arguments);\n\t\t};\n\t\ta.prototype = f.prototype;\n  } else a = {};\n  Object.defineProperty(a, '__esModule', {value: true});\n\tObject.keys(n).forEach(function (k) {\n\t\tvar d = Object.getOwnPropertyDescriptor(n, k);\n\t\tObject.defineProperty(a, k, d.get ? d : {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn n[k];\n\t\t\t}\n\t\t});\n\t});\n\treturn a;\n}\n";if(Tt(e,Jt)){const t=Ft(Lt(e,Jt));return{code:`var ${t} = {exports: {}}; export {${t} as __module}`,meta:{commonjs:{isCommonJS:!1}}}}if(Tt(e,Bt)){const t=Ft(Lt(e,Bt));return{code:`var ${t} = {}; export {${t} as __exports}`,meta:{commonjs:{isCommonJS:!1}}}}if(Tt(e,Ht)){const t=Lt(e,Ht);return Qt(t,!w(t)||g(t))}if(e.endsWith(Kt)){const t=e.slice(0,-15),{meta:{commonjs:o}}=this.getModuleInfo(t),n=o?.shebang??"";return function(e,t,o,n){const{meta:{commonjs:r},hasDefaultExport:s}=o(e);if(!r||r.isCommonJS!==Vt){const t=JSON.stringify(e);let o=`export * from ${t};`;return s&&(o+=`export { default } from ${t};`),n+o}const i=Zt(e,t,!0);return{...i,code:n+i.code}}(t,v(t),this.getModuleInfo,n)}if(Tt(e,Gt)){const t=Lt(e,Gt);return Zt(t,v(t),(await this.load({id:t})).moduleSideEffects)}if(e===zt)return function(e,t,o,n){return e?`${[...t.values()].map(((e,t)=>`import ${e.endsWith(".json")?`json${t}`:`{ __require as require${t} }`} from ${JSON.stringify(e)};`)).join("\n")}\n\nvar dynamicModules;\n\nfunction getDynamicModules() {\n\treturn dynamicModules || (dynamicModules = {\n${[...t.keys()].map(((e,t)=>`\t\t${JSON.stringify(It(e,o))}: ${e.endsWith(".json")?`function () { return json${t}; }`:`require${t}`}`)).join(",\n")}\n\t});\n}\n\nexport function ${At}(originalModuleDir) {\n\tfunction handleRequire(path) {\n\t\tvar resolvedPath = commonjsResolve(path, originalModuleDir);\n\t\tif (resolvedPath !== null) {\n\t\t\treturn getDynamicModules()[resolvedPath]();\n\t\t}\n\t\t${n?"return require(path);":Rt}\n\t}\n\thandleRequire.resolve = function (path) {\n\t\tvar resolvedPath = commonjsResolve(path, originalModuleDir);\n\t\tif (resolvedPath !== null) {\n\t\t\treturn resolvedPath;\n\t\t}\n\t\treturn require.resolve(path);\n\t}\n\treturn handleRequire;\n}\n\nfunction commonjsResolve (path, originalModuleDir) {\n\tvar shouldTryNodeModules = isPossibleNodeModulesPath(path);\n\tpath = normalize(path);\n\tvar relPath;\n\tif (path[0] === '/') {\n\t\toriginalModuleDir = '';\n\t}\n\tvar modules = getDynamicModules();\n\tvar checkedExtensions = ['', '.js', '.json'];\n\twhile (true) {\n\t\tif (!shouldTryNodeModules) {\n\t\t\trelPath = normalize(originalModuleDir + '/' + path);\n\t\t} else {\n\t\t\trelPath = normalize(originalModuleDir + '/node_modules/' + path);\n\t\t}\n\n\t\tif (relPath.endsWith('/..')) {\n\t\t\tbreak; // Travelled too far up, avoid infinite loop\n\t\t}\n\n\t\tfor (var extensionIndex = 0; extensionIndex < checkedExtensions.length; extensionIndex++) {\n\t\t\tvar resolvedPath = relPath + checkedExtensions[extensionIndex];\n\t\t\tif (modules[resolvedPath]) {\n\t\t\t\treturn resolvedPath;\n\t\t\t}\n\t\t}\n\t\tif (!shouldTryNodeModules) break;\n\t\tvar nextDir = normalize(originalModuleDir + '/..');\n\t\tif (nextDir === originalModuleDir) break;\n\t\toriginalModuleDir = nextDir;\n\t}\n\treturn null;\n}\n\nfunction isPossibleNodeModulesPath (modulePath) {\n\tvar c0 = modulePath[0];\n\tif (c0 === '/' || c0 === '\\\\') return false;\n\tvar c1 = modulePath[1], c2 = modulePath[2];\n\tif ((c0 === '.' && (!c1 || c1 === '/' || c1 === '\\\\')) ||\n\t\t(c0 === '.' && c1 === '.' && (!c2 || c2 === '/' || c2 === '\\\\'))) return false;\n\tif (c1 === ':' && (c2 === '/' || c2 === '\\\\')) return false;\n\treturn true;\n}\n\nfunction normalize (path) {\n\tpath = path.replace(/\\\\/g, '/');\n\tvar parts = path.split('/');\n\tvar slashed = parts[0] === '';\n\tfor (var i = 1; i < parts.length; i++) {\n\t\tif (parts[i] === '.' || parts[i] === '') {\n\t\t\tparts.splice(i--, 1);\n\t\t}\n\t}\n\tfor (var i = 1; i < parts.length; i++) {\n\t\tif (parts[i] !== '..') continue;\n\t\tif (i > 0 && parts[i - 1] !== '..' && parts[i - 1] !== '.') {\n\t\t\tparts.splice(--i, 2);\n\t\t\ti--;\n\t\t}\n\t}\n\tpath = parts.join('/');\n\tif (slashed && path[0] !== '/') path = '/' + path;\n\telse if (path.length === 0) path = '.';\n\treturn path;\n}`:`export function ${Mt}(path) {\n\t${Rt}\n}`}($,E,b,o);if(Tt(e,Ut)){const t=Lt(e,Ut);return async function(e,t,o){const n=Ft(e),{meta:{commonjs:r}}=await o({id:e});return r?r.isCommonJS?`export { __moduleExports as default } from ${JSON.stringify(e)};`:t?!0!==t&&("namespace"===t||!r.hasDefaultExport||"auto"===t&&r.hasNamedExports)?`import * as ${n} from ${JSON.stringify(e)}; export default ${n};`:`export { default } from ${JSON.stringify(e)};`:`import { getAugmentedNamespace } from "${Yt}"; import * as ${n} from ${JSON.stringify(e)}; export default /*@__PURE__*/getAugmentedNamespace(${n});`:Qt(e,t)}(t,g(t),this.load)}return null},shouldTransformCachedModule(...e){return D.shouldTransformCachedModule.call(this,...e)},transform(e,t){if(!m(t))return null;try{return I.call(this,e,t)}catch(e){return this.error(e,e.pos)}}}}function $o(e){void 0===e&&(e={});var t=j(e.include,e.exclude),o="indent"in e?e.indent:"\t";return{name:"json",transform:function(n,r){if(".json"!==r.slice(-5)||!t(r))return null;try{var s=JSON.parse(n);return{code:F(s,{preferConst:e.preferConst,compact:e.compact,namedExports:e.namedExports,includeArbitraryNames:e.includeArbitraryNames,indent:o}),map:{mappings:""}}}catch(e){return this.error({message:"Could not parse JSON file",id:r,cause:e}),null}}}}var So,jo={dom:!1,exclude:null,include:null},ko={".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".svg":"image/svg+xml",".webp":"image/webp"};function _o(e){void 0===e&&(e={});var t=Object.assign({},jo,e),o=j(t.include,t.exclude);return{name:"image",load:function(e){if(!o(e))return null;var n=ko[l(e)];if(!n)return null;this.addWatchFile(e);var r=n===ko[".svg"],s=r?"utf-8":"base64",i=function(e){var t=e.format,o=e.isSvg,n=e.mime,r=e.source;return o?G(r):"data:"+n+";"+t+","+r}({format:s,isSvg:r,mime:n,source:M(e,s).replace(/[\r\n]+/gm,"")});return(t.dom?'\n  var img = new Image();\n  img.src = "'+{dataUri:i}.dataUri+'";\n  export default img;\n':function(e){return'\n  var img = "'+e.dataUri+'";\n  export default img;\n'}({dataUri:i})).trim()}}}function Oo(e,t,o){var n=s(e[0]||".","."+t);t.endsWith("/")&&(n=s(n,"index.html")),T(n,(function(r,s){r&&e.length>1?Oo(e.slice(1),t,o):o(r,s,n)}))}function Fo(e,t){e.writeHead(404),e.end("404 Not Found\n\n"+t+"\n\n(rollup-plugin-serve)","utf-8")}function Do(e,t,o){e.writeHead(200,{"Content-Type":V.getType(t)}),e.end(o,"utf-8")}let Io;function Po(){return Io||(Io=No(9e3)),Io}function No(e){return new Promise((t=>{const o=X();o.unref(),o.on("error",(()=>{t(No(e+1))})),o.listen({port:e},(()=>{const n=X();n.unref(),n.on("error",(()=>{o.close((()=>{t(!1)}))})),n.listen({port:e},(()=>{n.close((()=>{o.close((()=>{t(!0)}))}))}))}))}))}function Co(e){return Po().then((t=>new Promise(t?t=>{!function(e,t){const o=ee({port:e},(()=>{o.end(),Ro(e+1,t)})).on("error",(()=>{t(e)}))}(e,t)}:t=>{Ro(e,t)})))}function Ro(e,t){const o=X();o.unref(),o.on("error",(()=>{Ro(e+1,t)})),o.listen({port:e},(()=>{o.close((()=>{t(e)}))}))}const Mo=global.PLUGIN_LIVERELOAD=global.PLUGIN_LIVERELOAD||{server:null};const Ao=()=>{try{return e=process.env.__TSLIB_TEST_PATH__||"tslib/tslib.es6.js",t={basedir:x(new URL(".",import.meta.url))},U.sync(e,t)}catch(e){return null}var e,t};function To(e,t,o){const n=`TS${o.code}`,r=e.flattenDiagnosticMessageText(o.messageText,"\n"),s={pluginCode:n,message:`@rollup/plugin-typescript ${n}: ${r}`};if(o.file){const{line:n,character:i}=o.file.getLineAndCharacterOfPosition(o.start);if(s.loc={column:i+1,line:n+1,file:o.file.fileName},t){const n=e.formatDiagnosticsWithColorAndContext([o],t);let i=n.slice(n.indexOf(r)+r.length);const a=t.getNewLine();i.startsWith(a)&&(i=i.slice(i.indexOf(a)+a.length)),s.frame=i}}return s}const qo={module:"esnext",skipLibCheck:!0},Lo={noEmit:!1,emitDeclarationOnly:!1},Uo={noEmitHelpers:!0,importHelpers:!0,noResolve:!1},Wo=["outDir","declarationDir"];const{ModuleKind:Ho,ModuleResolutionKind:Bo}=te;function Jo(e){return{...Uo,...e?{}:Lo}}function Ko(e){const t=e.options.module,o=t===Ho.Node16?Bo.Node16:t===Ho.NodeNext?Bo.NodeNext:Bo.NodeJs;return{...e,options:{moduleResolution:o,...e.options}}}const Go=new Map;function zo(e,t,o,n){const i=process.cwd();let a;!function(e,t){for(const o of Wo)e[o]&&(e[o]=s(t,e[o]))}(o,i);const l=function(e,t){if(!1===t)return null;const o=s(process.cwd(),t||"tsconfig.json");if(!e.sys.fileExists(o)){if(t)throw new Error(`Could not find specified tsconfig.json at ${o}`);return null}return o}(e,t)||void 0,c=l?function(e,t){const{config:o,error:n}=e.readConfigFile(t,(e=>M(e,"utf8")));if(n)throw Object.assign(Error(),To(e,null,n));return o||{}}(e,l):{},u=l?r(l):i;a=function(e){return["module","target","jsx","moduleResolution","newLine"].some((t=>t in e&&"number"==typeof e[t]))}(o)?Ko(e.parseJsonConfigFileContent({...c,compilerOptions:{...qo,...c.compilerOptions}},e.sys,u,{...o,...Jo(n)},l,void 0,void 0,Go)):Ko(e.parseJsonConfigFileContent({...c,compilerOptions:{...qo,...c.compilerOptions,...o}},e.sys,u,Jo(n),l,void 0,void 0,Go));const p=function(e,t){let o=!1;switch(t.inlineSourceMap?(t.sourceMap=!0,t.inlineSourceMap=!1):"boolean"!=typeof t.sourceMap&&(t.sourceMap=!0,t.inlineSources=!0,o=!0),t.module){case e.ModuleKind.ES2015:case e.ModuleKind.ESNext:case e.ModuleKind.Node16:case e.ModuleKind.NodeNext:case e.ModuleKind.CommonJS:return o;case e.ModuleKind.None:case e.ModuleKind.AMD:case e.ModuleKind.UMD:case e.ModuleKind.System:{const o=e.ModuleKind[t.module];throw new Error(`@rollup/plugin-typescript: The module kind should be 'ES2015', 'ESNext', 'node16' or 'nodenext', found: '${o}'`)}default:t.module=e.ModuleKind.ESNext}return o}(e,a.options);return{...a,autoSetSourceMap:p}}function Yo(e){return!Vo(e)&&!Qo(e)}function Vo(e){return e.endsWith(".map")}function Qo(e){return/\.d\.[cm]?ts$/.test(e)}function Zo(e,t,o){let n;return e&&(n=t.has(e)?t.get(e):o.getCached(e)),n}function Xo(e){return e.split(o.win32.sep).join(o.posix.sep)}const{ModuleKind:en}=te,tn="@rollup/plugin-typescript",on=`\n${tn}: Rollup requires that TypeScript produces ES Modules. Unfortunately your configuration specifies a\n "module" other than "esnext". Unless you know what you're doing, please change "module" to "esnext"\n in the target tsconfig.json file or plugin options.`.replace(/\n/g,""),nn=`${tn}: Could not find module 'tslib', which is required by this plugin. Is it installed?`;const rn=[en.ES2015,en.ES2020,en.ESNext,en.Node16,en.NodeNext,undefined];function sn(e,t,o){return function(n){!function(e,t,o,n){if(1204===n.code)return;const{noEmitOnError:r}=o.getCompilationSettings(),s=To(e,o,n);r&&n.category===e.DiagnosticCategory.Error?t.error(s):t.warn(s)}(e,t,o,n)}}const{DiagnosticCategory:an}=te;var ln;function cn(e){let t,o=()=>{};return t=e?Promise.race([new Promise((t=>setTimeout(t,e,!0))),new Promise((e=>o=e))]):new Promise((e=>o=e)),{promise:t,resolve:o}}!function(e){e[e.FILE_CHANGE_DETECTED=6032]="FILE_CHANGE_DETECTED",e[e.FOUND_1_ERROR_WATCHING_FOR_FILE_CHANGES=6193]="FOUND_1_ERROR_WATCHING_FOR_FILE_CHANGES",e[e.FOUND_N_ERRORS_WATCHING_FOR_FILE_CHANGES=6194]="FOUND_N_ERRORS_WATCHING_FOR_FILE_CHANGES"}(ln||(ln={}));class un{constructor(){this._startDeferred=null,this._finishDeferred=null}watch(e=1e3){this._startDeferred=cn(e),this._finishDeferred=cn()}handleStatus(e){if(e.category===an.Message)switch(e.code){case ln.FILE_CHANGE_DETECTED:this.resolveStart();break;case ln.FOUND_1_ERROR_WATCHING_FOR_FILE_CHANGES:case ln.FOUND_N_ERRORS_WATCHING_FOR_FILE_CHANGES:this.resolveFinish()}}resolveStart(){this._startDeferred&&(this._startDeferred.resolve(!1),this._startDeferred=null)}resolveFinish(){this._finishDeferred&&(this._finishDeferred.resolve(!1),this._finishDeferred=null)}async wait(){var e;if(this._startDeferred){await this._startDeferred.promise&&(this._startDeferred=null,this._finishDeferred=null),await(null===(e=this._finishDeferred)||void 0===e?void 0:e.promise)}}}function pn(e,t,o){return e.createWatchProgram(function(e,t,{formatHost:o,parsedOptions:n,writeFile:r,status:s,resolveModule:i,transformers:a}){const l=e.createEmitAndSemanticDiagnosticsBuilderProgram,c=e.createWatchCompilerHost(n.fileNames,n.options,e.sys,l,sn(e,t,o),s,n.projectReferences);let u;return{...c,afterProgramCreate(e){const t=e.emit;return e.emit=(o,n,s,i,l)=>(null!=u||(u="function"==typeof a?a(e.getProgram()):function(e,...t){const o=["after","afterDeclarations","before"],n={after:[],afterDeclarations:[],before:[]};let r,s;return t.forEach((t=>{t&&o.forEach((o=>{(function(e){return e||[]})(t[o]).forEach((t=>{if(t)if("type"in t){if("function"==typeof t.factory){let i;r=r||e.getProgram(),s=s||r.getTypeChecker(),"program"===t.type?(r=r||e.getProgram(),i=t.factory(r)):(r=r||e.getProgram(),s=s||r.getTypeChecker(),i=t.factory(s)),i&&n[o].push(i)}}else n[o].push(t)}))}))})),n}(e,a,l)),t(o,r,s,i,u)),c.afterProgramCreate(e)},resolveModuleNames:(t,o,n,r,s,a)=>t.map(((t,n)=>{var s;const l=a?null===(s=e.getModeForResolutionAtIndex)||void 0===s?void 0:s.call(e,a,n):void 0;return i(t,o,r,l)}))}}(e,t,o))}class dn{constructor(e=".rollup.cache"){this._cacheFolder=e}cachedFilename(e){return n.join(this._cacheFolder,e.replace(/^([a-zA-Z]+):/,"$1"))}cacheCode(e,t){const o=this.cachedFilename(e);(e=>{const t=n.dirname(e);N.mkdirSync(t,{recursive:!0})})(o),N.writeFileSync(o,t)}isCached(e){return N.existsSync(this.cachedFilename(e))}getCached(e){let t;return this.isCached(e)&&(t=N.readFileSync(this.cachedFilename(e),{encoding:"utf-8"})),t}}function mn(e={}){const{cacheDir:t,compilerOptions:n,exclude:s,filterRoot:i,include:a,outputToFilesystem:l,noForceEmit:u,transformers:p,tsconfig:d,tslib:m,typescript:f}=(e=>{const{cacheDir:t,exclude:o,include:n,filterRoot:r,noForceEmit:s,transformers:i,tsconfig:a,tslib:l,typescript:c,outputToFilesystem:u,compilerOptions:p,...d}=e;return{cacheDir:t,include:n,exclude:o,filterRoot:r,noForceEmit:s||!1,tsconfig:a,compilerOptions:{...d,...p},typescript:c||te,tslib:l||Ao(),transformers:i,outputToFilesystem:u}})(e),h=new dn(t),g=new Map,y=new un,w=zo(f,d,n,u),v=j(a||"{,**/}*.(cts|mts|ts|tsx)",s,{resolve:null!=i?i:w.options.rootDir});w.fileNames=w.fileNames.filter(v);const x=function(e,t){return{getCompilationSettings:()=>t,getCurrentDirectory:()=>process.cwd(),getNewLine(){switch(t.newLine){case e.NewLineKind.CarriageReturnLineFeed:return"\r\n";case e.NewLineKind.LineFeed:return"\n";default:return e.sys.newLine}},getCanonicalFileName:t=>e.sys.useCaseSensitiveFileNames?t:t.toLowerCase()}}(f,w.options),b=function(e,t,o){const n=t.getCompilationSettings(),r=e.createModuleResolutionCache(process.cwd(),t.getCanonicalFileName,n),s={...e.sys,...t};return(t,i,a,l)=>{const{resolvedModule:c}=e.resolveModuleName(t,i,n,s,r,a,l);return(null==c?void 0:c.isExternalLibraryImport)&&o(null==c?void 0:c.resolvedFileName)&&(c.isExternalLibraryImport=!1),c}}(f,x,v);let E=null;return{name:"typescript",buildStart(e){!function(e,t,o){o.errors.length>0&&(o.errors.forEach((o=>t.warn(To(e,null,o)))),t.error("@rollup/plugin-typescript: Couldn't process compiler options"))}(f,this,w),(({config:e,context:t,inputPreserveModules:o,tslib:n})=>{rn.includes(e.options.module)||t.warn(on),o||null!==n||t.error(nn)})({config:w,context:this,inputPreserveModules:e.preserveModules,tslib:m}),!0!==this.meta.watchMode&&(null==E||E.close(),E=null),E||(E=pn(f,this,{formatHost:x,resolveModule:b,parsedOptions:w,writeFile(e,t){(w.options.composite||w.options.incremental)&&h.cacheCode(e,t),g.set(e,t)},status(e){y.handleStatus(e)},transformers:p}))},watchChange(e){v(e)&&y.watch()},buildEnd(){!0!==this.meta.watchMode&&(null==E||E.close())},renderStart(e){!function(e,t,o,n){!t.sourceMap||o.sourcemap||n?!t.sourceMap&&o.sourcemap&&e.warn("@rollup/plugin-typescript: Typescript 'sourceMap' compiler option must be set to generate source maps."):e.warn("@rollup/plugin-typescript: Rollup 'sourcemap' option must be set to generate source maps.")}(this,w.options,e,w.autoSetSourceMap),function(e,t,o){t.out?e.error("@rollup/plugin-typescript: Deprecated Typescript compiler option 'out' is not supported. Use 'outDir' instead."):t.outFile&&e.error("@rollup/plugin-typescript: Typescript compiler option 'outFile' is not supported. Use 'outDir' instead.");let n=o.dir;o.file&&(n=r(o.file));for(const r of Wo)t[r]&&n&&(o.dir?c(n,t[r]).startsWith("..")&&e.error(`@rollup/plugin-typescript: Path of Typescript compiler option '${r}' must be located inside Rollup 'dir' option.`):"outDir"===r?c(t[r],n).startsWith("..")&&e.error(`@rollup/plugin-typescript: Path of Typescript compiler option '${r}' must be located inside the same directory as the Rollup 'file' option.`):c(n,t[r]).startsWith("..")&&e.error(`@rollup/plugin-typescript: Path of Typescript compiler option '${r}' must be located inside the same directory as the Rollup 'file' option.`));(t.declaration||t.declarationMap||t.composite)&&Wo.every((e=>!t[e]))&&e.error("@rollup/plugin-typescript: You are using one of Typescript's compiler options 'declaration', 'declarationMap' or 'composite'. In this case 'outDir' or 'declarationDir' must be specified to generate declaration files.")}(this,w.options,e)},resolveId(e,t){if("tslib"===e)return m;if(!t)return null;const n=Xo(t),r="function"==typeof f.getImpliedNodeFormatForFile?f.getImpliedNodeFormatForFile(n,void 0,{...f.sys,...x},w.options):void 0,s=b(e,n,void 0,r);return s?/\.d\.[cm]?ts/.test(s.extension)?null:v(s.resolvedFileName)?o.normalize(s.resolvedFileName):null:null},async load(e){if(!v(e))return null;this.addWatchFile(e),await y.wait();const t=Xo(e);w.fileNames.includes(t)||w.fileNames.push(t);const o=function(e,t,o,n,r){const s=e.getOutputFileNames(t,o,!e.sys.useCaseSensitiveFileNames),i=s.find(Yo),a=s.find(Vo);return{code:Zo(i,n,r),map:Zo(a,n,r),declarations:s.filter((e=>e!==i&&e!==a))}}(f,w,e,g,h);return null!=o.code?o:null},async generateBundle(e){[...g.keys()].filter((e=>Qo(e)||e.endsWith("ts.map"))).forEach((t=>{const n=Zo(t,g,h);if(!n||!w.options.declaration)return;let r;e.dir?r=e.dir:e.file&&(r=o.dirname(e.file)),r&&this.emitFile({type:"asset",fileName:Xo(o.relative(r,t)),source:n})}));const t=f.getTsBuildInfoEmitOutputFilePath(w.options);if(t){const n=g.get(t);n&&await async function({dir:e},t,n,r,s){const i=Xo(r),a=e?o.relative(e,i):"..";a.startsWith("..")?(null==t&&n.warn("@rollup/plugin-typescript: outputToFilesystem option is defaulting to true."),!1!==t&&(await q.mkdir(o.dirname(i),{recursive:!0}),await q.writeFile(i,s))):n.emitFile({type:"asset",fileName:a,source:s})}(e,l,this,t,n)}}}}const fn=x(import.meta.url),hn=r(fn);function gn(e={}){const{filename:t="index.html",title:o="App",template:r=n.resolve(hn,"../template.html"),links:s=[]}=e;return{name:"html-plugin",generateBundle(e,n){try{let e="";e=N.existsSync(r)?N.readFileSync(r,"utf-8"):'\n            <!DOCTYPE html>\n            <html lang="en">\n            <head>\n              <meta charset="UTF-8">\n              <meta name="viewport" content="width=device-width, initial-scale=1.0">\n              <title>{{title}}</title>\n              {{#each cssFiles}}\n              <link rel="stylesheet" href="{{this}}">\n              {{/each}}\n              {{#each links}}\n              <link rel="{{this.rel}}" href="{{this.href}}">\n              {{/each}}\n            </head>\n            <body>\n              <div id="root"></div>\n              \n              \x3c!-- 先加载第三方库和公共组件 --\x3e\n              {{#each chunks}}\n              <script type="module" src="{{this}}"><\/script>\n              {{/each}}\n              \n              \x3c!-- 再加载入口文件 --\x3e\n              {{#each jsFiles}}\n              <script type="module" src="{{this}}"><\/script>\n              {{/each}}\n            </body>\n            </html>\n          ';const i=Object.keys(n).filter((e=>e.endsWith(".js")&&"chunk"===n[e].type&&n[e].isEntry)).map((e=>n[e].fileName)),a=Object.keys(n).filter((e=>e.endsWith(".css"))).map((e=>n[e].fileName)),l=Object.keys(n).filter((e=>e.endsWith(".js")&&"chunk"===n[e].type&&!n[e].isEntry)).map((e=>n[e].fileName));console.log("入口JS文件:",i),console.log("CSS文件:",a),console.log("依赖的chunk文件:",l);s.map((e=>{if(e.href.includes("[hash]")){const t=e.href.replace(/\[hash\]/g,".*"),o=new RegExp(t.replace(/\./g,"\\.")),n=a.find((e=>o.test(e)));if(n)return console.log(`将占位符 ${e.href} 替换为实际文件: ${n}`),{...e,href:n}}return e}));const c=re.compile(e)({title:o,jsFiles:i,cssFiles:a,chunks:l});this.emitFile({type:"asset",fileName:t,source:c}),console.log(`HTML 文件 ${t} 已生成，包含 ${i.length} 个 JS 文件和 ${a.length} 个 CSS 文件`)}catch(e){console.error("HTML 插件错误:",e)}}}}function yn(){const e=["src/index.tsx","src/index.ts","src/index.jsx","src/index.js"];for(const t of e)if(N.existsSync(n.resolve(process.cwd(),t)))return console.log(`入口文件${t}`),t;throw new Error("未找到入口文件，请确保项目中存在以下文件之一：src/index.tsx, src/index.ts, src/index.jsx, src/index.js")}$t({extensions:[".js",".jsx",".ts",".tsx"],preferBuiltins:!0}),Eo({include:/node_modules/,transformMixedEsModules:!0}),$o(),Re({babelHelpers:"bundled",presets:["@babel/preset-env"]});const wn=process.env.OUTPUT_DIR||"dist",vn=process.env.OUTPUT_DIR||"build",xn={input:yn(),output:{dir:wn,format:"es",entryFileNames:"js/[name].[hash].js",chunkFileNames:"js/[name].[hash].js",assetFileNames:"assets/[name].[hash][extname]",sourcemap:!0,inlineDynamicImports:!1,manualChunks:e=>e.includes("node_modules")?e.includes("react")||e.includes("react-dom")?"vendor-react":"vendor":e.includes("/components/")?"components":void 0,banner:"var process = {\n  env: {\n    NODE_ENV: 'development',\n  }\n};"},watch:{include:"src/**",exclude:"node_modules/**",clearScreen:!1},plugins:[oe({plugins:[ae(),ie(),ne(),se({viewportWidth:375,viewportHeight:667,unitPrecision:5,viewportUnit:"vw",selectorBlackList:[],minPixelValue:1,mediaQuery:!1})],extract:e=>`css/index.${Date.now().toString(16).slice(0,8)}.css`,modules:{generateScopedName:"[name]_[local]_[hash:base64:5]"},use:["less"],sourceMap:!0,minimize:!0}),gn({filename:"index.html",title:"Seek App - Development",links:[{rel:"stylesheet",href:"css/index.[hash].css"}]}),$t({extensions:[".js",".jsx",".ts",".tsx",".less",".css"],preferBuiltins:!0}),Eo({include:/node_modules/,transformMixedEsModules:!0,esmExternals:!0}),mn({tsconfig:"./tsconfig.json",sourceMap:!0,inlineSources:!0,noEmitOnError:!0,incremental:!1,compilerOptions:{types:["node"]}}),Re({babelHelpers:"bundled",presets:["@babel/preset-env",["@babel/preset-react",{runtime:"automatic",development:!0}],"@babel/preset-typescript"],extensions:[".js",".jsx",".ts",".tsx"]}),$o(),_o(),function(e){void 0===e&&(e={contentBase:""}),(Array.isArray(e)||"string"==typeof e)&&(e={contentBase:e}),e.contentBase=Array.isArray(e.contentBase)?e.contentBase:[e.contentBase||""],e.port=e.port||10001,e.headers=e.headers||{},e.https=e.https||!1,e.openPage=e.openPage||"",e.onListening=e.onListening||function(){},V.default_type="text/plain",e.mimeTypes&&V.define(e.mimeTypes,!0);var t=function(t,o){var n=decodeURI(t.url.split("?")[0]),r=d.normalize(n);Object.keys(e.headers).forEach((function(t){o.setHeader(t,e.headers[t])})),Oo(e.contentBase,r,(function(t,n,r){if(!t)return Do(o,r,n);if("ENOENT"!==t.code)return o.writeHead(500),void o.end("500 Internal Server Error\n\n"+r+"\n\n"+Object.values(t).join("\n")+"\n\n(rollup-plugin-serve)","utf-8");if(e.historyApiFallback){var s="string"==typeof e.historyApiFallback?e.historyApiFallback:"/index.html";Oo(e.contentBase,s,(function(e,t,n){e?Fo(o,n):Do(o,n,t)}))}else Fo(o,r)}))};So?So.close():["SIGINT","SIGTERM","SIGQUIT","SIGHUP"].forEach((function(e){process.on(e,(function(){So&&(So.close(),process.exit())}))})),(So=e.https?z(e.https,t):Y(t)).listen(e.port,e.host,(function(){return e.onListening(So)}));var o=(e.https?"https":"http")+"://"+(e.host||"localhost")+":"+e.port;So.on("error",(function(e){if("EADDRINUSE"!==e.code)throw e;console.error(o+" is in use, either stop the other server or use a different port."),process.exit()}));var n=!0;return{name:"serve",generateBundle:function(){n&&(n=!1,!1!==e.verbose&&e.contentBase.forEach((function(e){console.log("[1m[32m"+o+"[39m[22m -> "+s(e))})),e.open&&(/https?:\/\/.+/.test(e.openPage)?Q(e.openPage):Q(o+e.openPage)))}}}({contentBase:[wn],host:"localhost",port:3e3,open:!0}),function(e={watch:""}){"string"==typeof e?e={watch:e}:e.watch=e.watch||"",Mo.server&&Mo.server.close();let t=!1===e.verbose;const o=Co(e.port||35729);return o.then((t=>{Mo.server=Z({...e,port:t}),Array.isArray(e.watch)?Mo.server.watch(e.watch.map((e=>s(process.cwd(),e)))):Mo.server.watch(s(process.cwd(),e.watch))})),{name:"livereload",async banner(){if(!1===e.inject)return;const t=await o;return`(function(l, r) { if (!l || l.getElementById('livereloadscript')) return; r = l.createElement('script'); r.async = 1; r.src = ${e.clientUrl?JSON.stringify(e.clientUrl):process.env.CODESANDBOX_SSE?`'//' + (self.location.host.replace(/^([^.]+)-\\d+/,"$1").replace(/^([^.]+)/, "$1-${t}")).split(':')[0] + '/livereload.js?snipver=1&port=443'`:`'//' + (self.location.host || 'localhost').split(':')[0] + ':${t}/livereload.js?snipver=1'`}; r.id = 'livereloadscript'; l.getElementsByTagName('head')[0].appendChild(r) })(self.document);`},async generateBundle(){if(!t){t=!0;const e=await o,n=35729!==e?" on port "+e:"";console.log("[1m[32m"+("LiveReload enabled"+n)+"[39m[22m")}}}}({watch:wn})]},bn={input:yn(),output:{dir:vn,format:"es",entryFileNames:"js/[name].[hash].js",chunkFileNames:"js/[name].[hash].js",assetFileNames:"assets/[name].[hash][extname]",sourcemap:!1,inlineDynamicImports:!1,manualChunks:e=>e.includes("node_modules")?e.includes("react")||e.includes("react-dom")?"vendor-react":"vendor":e.includes("/components/")?"components":void 0,banner:"var process = {\n  env: {\n    NODE_ENV: 'production',\n  }\n};"},external:[],plugins:[oe({plugins:[ae(),ie(),ne(),se({viewportWidth:375,viewportHeight:667,unitPrecision:5,viewportUnit:"vw",selectorBlackList:[],minPixelValue:1,mediaQuery:!1})],extract:e=>`css/index.${Date.now().toString(16).slice(0,8)}.css`,modules:{generateScopedName:"[name]_[local]_[hash:base64:5]"},use:["less"],sourceMap:!0,minimize:!0}),gn({filename:"index.html",title:"Seek App - Production",links:[{rel:"stylesheet",href:"css/index.[hash].css"}]}),$t({extensions:[".js",".jsx",".ts",".tsx",".less",".css"],preferBuiltins:!0}),Eo({include:/node_modules/,transformMixedEsModules:!0}),mn({tsconfig:"./tsconfig.json",sourceMap:!0,inlineSources:!0,noEmitOnError:!0,incremental:!1,compilerOptions:{types:["node"]}}),Re({babelHelpers:"bundled",presets:["@babel/preset-env","@babel/preset-react","@babel/preset-typescript"],extensions:[".js",".jsx",".ts",".tsx"]}),$o(),_o()]},En=x(import.meta.url),$n=r(En),Sn=JSON.parse(m.readFileSync(n.join($n,"../package.json"),"utf8")),jn=Sn.version;e.version(jn,"-v, --version","显示版本号").command("v").description("显示版本信息").action((()=>{console.log(t.blue("版本信息：")),console.log(t.green(`seek-app: ${jn}`)),console.log(t.green(`Node.js: ${process.version}`)),process.exit(0)})),e.command("path").alias("pt").description("显示路径信息").action((()=>{console.log(t.blue(`安装路径：${$n}`)),process.exit(0)})),e.command("update").alias("u").description("更新到最新版本").action((async()=>{console.log(t.yellow(`当前版本：${jn}`)),console.log(t.blue("正在更新 seek-app 到最新版本...")),h("npm view seek-app version",((e,o,n)=>{e&&(console.error(t.red(`获取最新版本号失败：${e.message}`)),process.exit(1));const r=o.trim();r===jn&&(console.log(t.yellow("当前已是最新版本！")),process.exit(0)),h("npm i seek-app@latest -g",(async(e,o,n)=>{e?console.error(t.red(`更新失败：${e.message}`)):(console.log(t.green(`更新成功！新版本号：${r}`)),process.exit(0))}))}))})),e.command("debug").alias("d").description("调试模式").action((async e=>{console.log(t.blue("===== 调试信息 =====")),console.log(t.yellow("版本信息：")),console.log(`当前版本：${jn}`),console.log(t.yellow("\n环境信息：")),console.log(`Node.js 版本：${process.version}`),console.log(`操作系统：${process.platform}`),console.log(`系统架构：${process.arch}`),console.log(t.yellow("\n依赖信息：")),Object.entries(Sn.dependencies).forEach((([e,t])=>{console.log(`${e}: ${t}`)})),h("npm root -g",((e,o,n)=>{e||(console.log(t.yellow("\n全局安装路径：")),console.log(o.trim()))})),console.log(t.blue("\n===== 调试信息结束 =====")),process.exit(0)})),e.command("close-debug").alias("c").description("关闭调试模式").action((async()=>{console.log(t.blue("===== 关闭调试模式 =====")),process.env.NODE_ENV="production",console.log(t.yellow("已关闭调试模式")),console.log(t.yellow("当前环境：")+t.green(process.env.NODE_ENV)),console.log(t.yellow("\n调试状态：")+t.red("已关闭")),console.log(t.blue("\n===== 调试模式已关闭 =====")),process.exit(0)})),e.command("git").alias("g").description("git操作").action((async e=>{console.log(t.green("******执行git自动化命令******"));const o=n.join($n,"git-auto.js"),r=f("node",[o],{stdio:"inherit",shell:!0});r.on("error",(e=>{console.error(t.red(`执行失败：${e.message}`))})),r.on("close",(e=>{0!==e&&console.error(t.red(`命令执行失败，退出码：${e}`)),console.log(t.yellow("\n执行结束"))}))})),e.command("cmodule").alias("cm").description("创建组件模块").action((async e=>{console.log(t.green("******执行创建模块自动化命令******"));const o=n.join($n,"create-module.js"),r=f("node",[o],{stdio:"inherit",shell:!0});r.on("error",(e=>{console.error(t.red(`执行失败：${e.message}`))})),r.on("close",(e=>{0!==e&&console.error(t.red(`命令执行失败，退出码：${e}`)),console.log(t.yellow("\n执行结束"))}))})),e.command("typescript").alias("ts").description("自动化生成ts命令").action((async e=>{console.log(t.green("******执行typscript自动化命令******"));const o=n.join($n,"interface-auto.js"),r=f("node",[o],{stdio:"inherit",shell:!0});r.on("error",(e=>{console.error(t.red(`执行失败：${e.message}`))})),r.on("close",(e=>{0!==e&&console.error(t.red(`命令执行失败，退出码：${e}`)),console.log(t.yellow("\n执行结束")),process.exit(1)}))})),e.command("lint").alias("l").description("代码检查").option("-d, --dir <dir>","指定要检查的目录",process.cwd()).option("-f, --fix","自动修复问题").option("-e, --ext <extensions>","指定要检查的文件扩展名，用逗号分隔",".js,.jsx,.ts,.tsx").action((async e=>{await async function(e){console.log(t.green("******配置 ESLint******"));try{const o=process.cwd();if(!m.existsSync(n.join(o,"package.json")))return void console.error(t.red("错误：当前目录不是有效的项目目录"));const r=n.join(pe,"eslint.config.js"),s=m.readFileSync(r,"utf8"),i=g.format(s,{parser:"babel",semi:!0,singleQuote:!0,trailingComma:"es5",printWidth:100,tabWidth:2,useTabs:!1,bracketSpacing:!0,arrowParens:"avoid"}),a=n.join(o,"eslint.config.js");m.existsSync(a)||(m.writeFileSync(a,i),console.log(t.green("✓ 创建eslint.config.js成功")));const l=n.join(pe,".eslintrc.json"),c=m.readFileSync(l,"utf8"),u=n.join(o,".eslintrc.json");m.existsSync(u)||(m.writeFileSync(u,c),console.log(t.green("✓ 创建.eslintrc.json成功")));const p="node_modules\ndist\nbuild\ncoverage\n.next\n.eslintignore\neslint.config.js\n.prettierrc.js\nstatic\neslint.config.js".trim();await m.writeFile(n.join(o,".eslintignore"),p);const d=["eslint@^7.0.0","eslint-plugin-react","eslint-plugin-react-hooks","eslint-plugin-jsx-a11y","eslint-config-react-app","@typescript-eslint/parser@^4.0.0","@typescript-eslint/eslint-plugin@^4.0.0","eslint-plugin-prettier","eslint-config-prettier","eslint-plugin-prettier","prettier"];console.log(t.blue("正在安装 ESLint 相关依赖...")),v("npm",["install","--save-dev",...d,"--force"],{cwd:o,stdio:"inherit"}).on("close",(async r=>{if(0===r){console.log(t.green("✓ ESLint 依赖安装成功"));const r=n.join(o,"package.json"),s=de(r);s.scripts||(s.scripts={}),s.scripts.lint="eslint . --ext .js,.jsx,.ts,.tsx",s.scripts["lint:fix"]="eslint . --ext .js,.jsx,.ts,.tsx --fix",await m.writeJSON(r,s,{spaces:2}),console.log(t.green("✓ 已添加 lint 脚本到 package.json")),console.log(t.green("✓ 已创建 .eslintignore 文件")),console.log(t.blue("\n现在你可以使用以下命令：")),console.log(t.yellow("npm run lint      - 检查代码")),console.log(t.yellow("npm run lint:fix  - 自动修复代码")),null==e||e()}else console.error(t.red("依赖安装失败"))}))}catch(e){console.error(t.red(`配置 ESLint 失败：${e.message}`))}}((async()=>{try{console.log(t.blue("开始代码检查..."));const o=e.ext.split(",").map((e=>e.trim())),n=await ce({targetDir:e.dir,extensions:o,fix:e.fix});n>0?(console.log(t.red(`检查完成，发现 ${n} 个错误`)),process.exit(1)):console.log(t.green("检查完成，未发现错误"))}catch(e){console.error(t.red(`代码检查失败：${e.message}`)),process.exit(1)}}))})),e.command("prettier").alias("p").description("格式化代码").option("-d, --dir <dir>","指定要美化的目录",process.cwd()).option("-e, --ext <extensions>","指定要美化的文件扩展名，用逗号分隔",".js,.jsx,.ts,.tsx").action((async e=>{try{const e=["prettier@^2.0.0"],o=process.cwd();f("npm",["install","--save-dev",...e,"--force"],{cwd:o,stdio:"inherit"}).on("close",(async e=>{0===e?async function(e){try{const o=process.cwd();if(!m.existsSync(n.join(o,"package.json")))return void console.error(t.red("当前目录下不存在 package.json 文件"));const r=n.join(o,".prettierrc.js");if(!m.existsSync(r)){const e=n.join(fe,".prettierrc.js"),o=m.readFileSync(e,"utf-8"),s=g.format(o,{parser:"babel",semi:!0,singleQuote:!0,trailingComma:"es5",printWidth:100,tabWidth:2,useTabs:!1,bracketSpacing:!0,arrowParens:"avoid"});await m.writeFile(r,s),console.log(t.green("生成 .prettierrc 文件成功"))}const s=n.join(o,".prettierignore");if(!m.existsSync(s)){const e=n.join(fe,".prettierignore"),o=m.readFileSync(e,"utf-8");await m.writeFile(s,o),console.log(t.green("生成 .prettierignore 文件成功"))}const i=n.join(o,"package.json"),a=he(i);a.scripts||(a.scripts={}),a.scripts.prettier||(a.scripts.prettier="prettier --write --ignore-unknown .",await m.writeJSON(i,a,{spaces:2}),console.log(t.green("添加 prettier 脚本成功"))),null==e||e()}catch(e){console.error(t.red(`配置 prettier 失败：${e.message}`))}}((()=>{console.log(t.green("✓ 安装prettier 依赖成功")),console.log(t.blue("\n现在你可以使用以下命令：")),console.log(t.yellow("执行 npm run prettier - 格式化代码")),process.exit(1)})):console.error(t.red("依赖安装失败"))}))}catch(e){console.log(e)}})),e.command("rule").alias("r").description("代码审核").option("-d, --dir <directory>","指定要审核的目录",process.cwd()).option("-m, --model <model>","指定 AI 模型","gpt-4").option("-t, --temperature <number>","设置温度参数","0.7").option("-k, --max-tokens <number>","设置最大 token 数","2000").action((async e=>{await async function(e={}){console.log(t.green("******开始多模型代码审核******"));try{const o=[];if(process.env.HUGGING_FACE_API_KEY&&o.push("Hugging Face (BLOOM)"),process.env.DASHSCOPE_API_KEY&&o.push("通义千问"),process.env.OPENAI_API_KEY&&o.push("OpenAI GPT"),0===o.length)return console.log(t.yellow("提示：未设置任何 API Key")),console.log(t.blue("\n请设置以下环境变量之一：")),console.log(t.blue("\n1. Hugging Face API Key:")),console.log(t.white("   # Linux/Mac:")),console.log(t.gray("   export HUGGING_FACE_API_KEY=你的API密钥")),console.log(t.white("   # Windows CMD:")),console.log(t.gray("   set HUGGING_FACE_API_KEY=你的API密钥")),console.log(t.white("   # Windows PowerShell:")),console.log(t.gray('   $env:HUGGING_FACE_API_KEY="你的API密钥"')),console.log(t.blue("\n2. 通义千问 API Key:")),console.log(t.white("   # Linux/Mac:")),console.log(t.gray("   export DASHSCOPE_API_KEY=你的API密钥")),console.log(t.white("   # Windows CMD:")),console.log(t.gray("   set DASHSCOPE_API_KEY=你的API密钥")),console.log(t.white("   # Windows PowerShell:")),console.log(t.gray('   $env:DASHSCOPE_API_KEY="你的API密钥"')),console.log(t.blue("\n3. OpenAI API Key:")),console.log(t.white("   # Linux/Mac:")),console.log(t.gray("   export OPENAI_API_KEY=你的API密钥")),console.log(t.white("   # Windows CMD:")),console.log(t.gray("   set OPENAI_API_KEY=你的API密钥")),console.log(t.white("   # Windows PowerShell:")),console.log(t.gray('   $env:OPENAI_API_KEY="你的API密钥"')),console.log(t.blue("\n获取方式：")),console.log(t.blue("- Hugging Face: https://huggingface.co/settings/tokens")),console.log(t.blue("- 通义千问: https://dashscope.aliyuncs.com/")),console.log(t.blue("- OpenAI: https://platform.openai.com/api-keys")),void console.log(t.yellow("\n注意：设置环境变量后需要重新打开终端才能生效"));console.log(t.green("可用的模型：")),o.forEach((e=>{console.log(t.blue(`- ${e}`))}));const n=new le(e),r=e.targetDir||process.cwd();console.log(t.blue(`\n正在扫描目录：${r}`)),console.log(t.blue("将使用所有可用的模型进行代码审核..."));const s=await n.reviewDirectory(r);if(Object.values(s).every((e=>0===e.length)))return void console.log(t.yellow("没有找到需要审核的代码文件"));const i=n.generateHtmlReport(s);console.log(t.green(`✓ 多模型代码审核对比报告已生成：${i}`)),"darwin"===process.platform?f("open",[i]):"win32"===process.platform?f("cmd",["/c","start",i]):f("xdg-open",[i])}catch(e){console.error(t.red(`代码审核失败：${e.message}`))}}({targetDir:e.dir,model:e.model,temperature:parseFloat(e.temperature),maxTokens:parseInt(e.maxTokens)})})),e.command("create <project-name>").alias("ct").description("创建一个新的 Seek App 项目").action((async e=>{try{console.log(t.blue("正在创建项目..."));const o=n.resolve($n,"../template"),r=n.resolve(process.cwd(),e);m.existsSync(r)&&(console.error(t.red(`错误: 目录 ${e} 已存在`)),process.exit(1)),m.copySync(o,r),process.chdir(r),console.log(t.blue("正在安装依赖...")),h("npm install",{stdio:"inherit"}),console.log(t.green("\n项目创建成功！")),console.log(t.blue("\n开始使用:")),console.log(t.white(`  cd ${e}`)),console.log(t.white("  npm start"))}catch(e){console.error(t.red("创建项目失败:"),e),process.exit(1)}})),e.command("s").description("启动开发服务器").option("-p, --port <port>","指定端口号","3000").option("-h, --host <host>","指定主机名","localhost").option("-o, --open","自动打开浏览器").option("-d, --dir <dir>","指定输出目录","dist").action((async e=>{try{process.env.NODE_ENV="development",process.env.OUTPUT_DIR=e.dir;const o=n.resolve(process.cwd(),e.dir);m.existsSync(o)?m.rmSync(o,{recursive:!0,force:!0}):m.mkdirSync(o,{recursive:!0});const r=await import("rollup"),s=await r.watch(xn);if(console.log(t.green("开发服务器已启动")),console.log(t.blue(`访问地址: http://${e.host}:${e.port}`)),e.open){const t=await import("open");await t.default(`http://${e.host}:${e.port}`)}s.on("event",(e=>{"ERROR"===e.code?console.error(t.red("构建错误:"),e.error):"BUNDLE_END"===e.code&&console.log(t.green("构建完成"))})),process.on("SIGINT",(async()=>{await s.close(),process.exit(0)}))}catch(e){console.error(t.red("启动开发服务器失败:"),e),process.exit(1)}})),e.command("build").alias("b").description("构建生产环境代码").option("-o, --output <dir>","指定输出目录","build").option("-c, --config <path>","自定义配置文件路径").action((async e=>{console.log(t.green("******欢迎使用seek-app脚手架******"));try{process.env.NODE_ENV="production",process.env.OUTPUT_DIR=e.output,console.log("production","======rollupConfig");const o=n.resolve(process.cwd(),e.output);console.log(`正在清空目录：${o}`),m.existsSync(o)?m.rmSync(o,{recursive:!0,force:!0}):m.mkdirSync(o,{recursive:!0});const r=Date.now(),s=await import("rollup"),i=await s.rollup(bn),{output:a}=await i.write(bn.output);let l=0;a.forEach((o=>{const r=n.join(e.output,o.fileName),s=(m.statSync(r).size/1024).toFixed(2);l+=parseFloat(s),console.log(t.green(`文件：${o.fileName}，大小：${s} KB`))}));const c=(Date.now()-r)/1e3;console.log(t.green(`构建完成，输出目录：${e.output}`)),console.log(t.blue(`构建耗时：${c} 秒`)),console.log(t.blue(`总大小：${l} KB`)),process.exit(1)}catch(e){console.error(t.red(`构建失败：${e.message}`)),process.exit(1)}})),e.parse(process.argv);
